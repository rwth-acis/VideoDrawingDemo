!function(n){"use strict";var e=n.querySelector("#app");e.displayInstalledToast=function(){n.querySelector("#caching-complete").show()},e.addEventListener("dom-change",function(){console.log("Our app is ready to rock!")}),window.addEventListener("WebComponentsReady",function(){var e=new Y.WebRTC("video-drawing-demo2");window.y=new Y(e);var a=!1;n.querySelector("#video1").addEventListener("loadedmetadata",function(o){e.whenSynced(function(){var e=function(e){var o=e.val();for(var t in o){var i=o[t].val();i.forEach(function(e){var a={time:t,type:"drawing",data:e};n.querySelector("sevianno-video-controls").addAnnotation(a)})}e.observe(function(o){for(var t in o)if("add"===o[t].type){var i=e.val(o[t].name),r=o[t].name,d=i.val();for(var v in d){var l={};l.time=r,l.type="drawing",l.data=JSON.parse(d[v]),n.querySelector("sevianno-video-controls").addAnnotation(l)}i.observe(function(e){for(var o in e)if("insert"===e[o].type&&e[o].changedBy!==y._model.connector.user_id){var t=i.val(e[o].position),d={};d.time=r,d.type="drawing",d.data=JSON.parse(t),a=!0,n.querySelector("sevianno-video-controls").addAnnotation(d),a=!1}})}})};y.observe(function(n){for(var a in n)"annotations"===n[a].name&&e(n[a].object.val("annotations"))}),null==y.val("annotations")?y.val("annotations",new Y.Object):e(y.val("annotations"))})}),n.querySelector("sevianno-video-controls").addEventListener("sevianno-annotation-added",function(n){if(!a&&y._model.connector.is_synced){var e=n.detail.time,o=y.val("annotations").val(e);null==o?y.val("annotations").val(e,new Y.List([JSON.stringify(n.detail.data)])):y.val("annotations").val(e).push(JSON.stringify(n.detail.data))}})}),e.onMenuSelect=function(){var e=n.querySelector("#paperDrawerPanel");e.narrow&&e.closeDrawer()}}(document);