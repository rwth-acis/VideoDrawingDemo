!function(n){"use strict";var a=n.querySelector("#app");a.displayInstalledToast=function(){n.querySelector("#caching-complete").show()},a.addEventListener("dom-change",function(){console.log("Our app is ready to rock!")}),window.addEventListener("WebComponentsReady",function(){var a=(new Y.XMPP).join("video-drawing-demo");window.y=new Y(a);var o=!1,e=function(a,e){var t={};t.time=a,t.type="drawing",t.data=JSON.parse(e),o=!0,n.querySelector("sevianno-video-controls").addAnnotation(t),o=!1},t=function(n){var a=n.val();for(var t in a){var r=a[t].val(),v=t;i(v,a[t]),r.forEach(function(n){e(t,n)})}n.observe(function(a){for(var t in a)if("add"===a[t].type){var r=n.val(a[t].name),v=a[t].name,l=r.val();if(!o)for(var s in l)e(v,l[s]);i(v,r)}})},i=function(n,a){a.observe(function(o){for(var t in o)if("insert"===o[t].type&&o[t].changedBy!==y._model.connector.user_id){var i=a.val(o[t].position);e(n,i)}})};n.querySelector("#video1").addEventListener("loadedmetadata",function(e){a.whenSynced(function(){y.observe(function(n){for(var a in n)"annotations"===n[a].name&&t(n[a].object.val("annotations"))}),null==y.val("annotations")?y.val("annotations",new Y.Object):t(y.val("annotations"));var a=n.querySelector("sevianno-video-controls").getAnnotations();for(var e in a){var i=a[e].time,r=y.val("annotations").val(i);o=!0;var v=a[e].objects;for(var l in v)0==l&&null==r?y.val("annotations").val(i,new Y.List([JSON.stringify(v[l])])):y.val("annotations").val(i).push(JSON.stringify(v[l]));o=!1}})}),n.querySelector("sevianno-video-controls").addEventListener("sevianno-annotation-added",function(n){if(!o&&y._model.connector.is_synced){var a=n.detail.time,e=y.val("annotations").val(a);null==e?(o=!0,y.val("annotations").val(a,new Y.List([JSON.stringify(n.detail.data)])),o=!1):(o=!0,y.val("annotations").val(a).push(JSON.stringify(n.detail.data)),o=!1)}})}),a.onMenuSelect=function(){var a=n.querySelector("#paperDrawerPanel");a.narrow&&a.closeDrawer()}}(document);