!function(n){"use strict";var a=n.querySelector("#app");a.displayInstalledToast=function(){n.querySelector("#caching-complete").show()},a.addEventListener("dom-change",function(){console.log("Our app is ready to rock!")}),window.addEventListener("WebComponentsReady",function(){var a=(new Y.XMPP).join("video-drawing-demo");window.y=new Y(a);var e=!1;n.querySelector("#video1").addEventListener("loadedmetadata",function(o){a.whenSynced(function(){var a=function(a){var o=a.val();for(var t in o){var i=o[t].val();i.forEach(function(a){var o={time:t,type:"drawing",data:a};e=!0,n.querySelector("sevianno-video-controls").addAnnotation(o),e=!1})}a.observe(function(o){for(var t in o)if("add"===o[t].type){var i=a.val(o[t].name),r=o[t].name,d=i.val();if(!e)for(var v in d){var l={};l.time=r,l.type="drawing",l.data=JSON.parse(d[v]),e=!0,n.querySelector("sevianno-video-controls").addAnnotation(l),e=!1}i.observe(function(a){for(var o in a)if("insert"===a[o].type&&a[o].changedBy!==y._model.connector.user_id){var t=i.val(a[o].position),d={};d.time=r,d.type="drawing",d.data=JSON.parse(t),e=!0,n.querySelector("sevianno-video-controls").addAnnotation(d),e=!1}})}})};y.observe(function(n){for(var e in n)"annotations"===n[e].name&&a(n[e].object.val("annotations"))}),null==y.val("annotations")?y.val("annotations",new Y.Object):a(y.val("annotations"))})}),n.querySelector("sevianno-video-controls").addEventListener("sevianno-annotation-added",function(n){if(!e&&y._model.connector.is_synced){var a=n.detail.time,o=y.val("annotations").val(a);null==o?(e=!0,y.val("annotations").val(a,new Y.List([JSON.stringify(n.detail.data)])),e=!1):(e=!0,y.val("annotations").val(a).push(JSON.stringify(n.detail.data)),e=!1)}})}),a.onMenuSelect=function(){var a=n.querySelector("#paperDrawerPanel");a.narrow&&a.closeDrawer()}}(document);