!function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var u=n[s]={exports:{}};e[s][0].call(u.exports,function(t){var n=e[s][1][t];return i(n?n:t)},u,u.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){var r,i,o,s,a,c;if(r=t("node-xmpp-client"),c=t("ltx"),a=function(t){return t.split("/")[1]},s=function(t){return t.split("/")[0]},o=function(){function t(t){var e;null==t&&(t={}),this.rooms={},null!=t.node_xmpp_client?this.xmpp=t.node_xmpp_client:(this.defaultRoomComponent=null!=t.defaultRoomComponent?t.defaultRoomComponent:"@conference.yatta.ninja",e={},null!=t.jid?(e.jid=t.jid,e.password=t.password):(e.jid="@yatta.ninja",e.preferred="ANONYMOUS"),null!=t.host?(e.host=t.host,e.port=t.port):(null==t.websocket&&(t.websocket="wss:yatta.ninja:5281/xmpp-websocket"),e.websocket={url:t.websocket}),this.xmpp=new r.Client(e)),this.is_online=!1,this.connections={},this.when_online_listeners=[],this.xmpp.on("online",function(t){return function(){return t.setIsOnline()}}(this)),this.xmpp.on("stanza",function(t){return function(e){var n;return e.getAttribute(!1)&&console.error(e.toString()),n=s(e.getAttribute("from")),null!=t.rooms[n]?t.rooms[n].onStanza(e):void 0}}(this)),this.debug=!1}return t.prototype.whenOnline=function(t){return this.is_online?t():this.when_online_listeners.push(t)},t.prototype.setIsOnline=function(){var t,e,n,r;for(r=this.when_online_listeners,e=0,n=r.length;n>e;e++)(t=r[e])();return this.is_online=!0},t.prototype.join=function(t,e){var n;if(null==e&&(e={}),null==e.role&&(e.role="slave"),null==e.syncMethod&&(e.syncMethod="syncAll"),null==t)throw new Error("you must specify a room!");return-1===t.indexOf("@")&&(t+=this.defaultRoomComponent),null==this.rooms[t]&&(n=new i,this.rooms[t]=n,this.whenOnline(function(r){return function(){var i;return i=function(){var i;return n.init({syncMethod:e.syncMethod,role:e.role,user_id:r.xmpp.jid.resource}),n.room=t,n.room_jid=t+"/"+r.xmpp.jid.resource,n.xmpp=r.xmpp,n.xmpp_handler=r,i=new c.Element("presence",{to:n.room_jid}).c("x",{}).up().c("role",{xmlns:"http://y.ninja/role"}).t(n.role),r.xmpp.send(i)},n.is_bound_to_y?i():n.on_bound_to_y=i}}(this))),this.rooms[t]},t}(),i=function(){function t(){}return t.prototype.exit=function(){return this.xmpp.send(new c.Element("presence",{to:this.room_jid,type:"unavailable"})),delete this.xmpp_handler.rooms[this.room]},t.prototype.onStanza=function(t){var e,n,r;if(this.debug&&console.log("RECEIVED: "+t.toString()),n=a(t.getAttribute("from")),t.is("presence")){if(n!==this.user_id)return"unavailable"===t.getAttribute("type")?this.userLeft(n):(r=t.getChild("role","http://y.ninja/role").getText(),this.userJoined(n,r))}else{if(n===this.room_jid)return!0;if(e=t.getChild("y","http://y.ninja/connector-stanza"),null!=e)return this.receiveMessage(n,this.parseMessageFromXml(e))}},t.prototype.send=function(t,e,n){var r,i;return null==n&&(n="message"),r=new c.Element("message",{to:""===t?this.room:this.room+"/"+t,type:null!=n?n:"chat"}),i=this.encodeMessageToXml(r,e),this.debug&&console.log("SENDING: "+i.root().toString()),this.xmpp.send(i.root())},t.prototype.broadcast=function(t){return this.send("",t,"groupchat")},t}(),null!=e.exports&&(e.exports=o),"undefined"!=typeof window&&null!==window){if("undefined"==typeof Y||null===Y)throw new Error("You must import Y first!");Y.XMPP=o}},{ltx:24,"node-xmpp-client":28}],2:[function(t,e,n){},{}],3:[function(t,e,n){function r(t,e){return f.isUndefined(e)?""+e:!f.isNumber(e)||!isNaN(e)&&isFinite(e)?f.isFunction(e)||f.isRegExp(e)?e.toString():e:e.toString()}function i(t,e){return f.isString(t)?t.length<e?t:t.slice(0,e):t}function o(t){return i(JSON.stringify(t.actual,r),128)+" "+t.operator+" "+i(JSON.stringify(t.expected,r),128)}function s(t,e,n,r,i){throw new g.AssertionError({message:n,actual:t,expected:e,operator:r,stackStartFunction:i})}function a(t,e){t||s(t,!0,e,"==",g.ok)}function c(t,e){if(t===e)return!0;if(f.isBuffer(t)&&f.isBuffer(e)){if(t.length!=e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}return f.isDate(t)&&f.isDate(e)?t.getTime()===e.getTime():f.isRegExp(t)&&f.isRegExp(e)?t.source===e.source&&t.global===e.global&&t.multiline===e.multiline&&t.lastIndex===e.lastIndex&&t.ignoreCase===e.ignoreCase:f.isObject(t)||f.isObject(e)?l(t,e):t==e}function u(t){return"[object Arguments]"==Object.prototype.toString.call(t)}function l(t,e){if(f.isNullOrUndefined(t)||f.isNullOrUndefined(e))return!1;if(t.prototype!==e.prototype)return!1;if(u(t))return u(e)?(t=d.call(t),e=d.call(e),c(t,e)):!1;try{var n,r,i=y(t),o=y(e)}catch(s){return!1}if(i.length!=o.length)return!1;for(i.sort(),o.sort(),r=i.length-1;r>=0;r--)if(i[r]!=o[r])return!1;for(r=i.length-1;r>=0;r--)if(n=i[r],!c(t[n],e[n]))return!1;return!0}function h(t,e){return t&&e?"[object RegExp]"==Object.prototype.toString.call(e)?e.test(t):t instanceof e?!0:e.call({},t)===!0?!0:!1:!1}function p(t,e,n,r){var i;f.isString(n)&&(r=n,n=null);try{e()}catch(o){i=o}if(r=(n&&n.name?" ("+n.name+").":".")+(r?" "+r:"."),t&&!i&&s(i,n,"Missing expected exception"+r),!t&&h(i,n)&&s(i,n,"Got unwanted exception"+r),t&&i&&n&&!h(i,n)||!t&&i)throw i}var f=t("util/"),d=Array.prototype.slice,m=Object.prototype.hasOwnProperty,g=e.exports=a;g.AssertionError=function(t){this.name="AssertionError",this.actual=t.actual,this.expected=t.expected,this.operator=t.operator,t.message?(this.message=t.message,this.generatedMessage=!1):(this.message=o(this),this.generatedMessage=!0);var e=t.stackStartFunction||s;if(Error.captureStackTrace)Error.captureStackTrace(this,e);else{var n=new Error;if(n.stack){var r=n.stack,i=e.name,a=r.indexOf("\n"+i);if(a>=0){var c=r.indexOf("\n",a+1);r=r.substring(c+1)}this.stack=r}}},f.inherits(g.AssertionError,Error),g.fail=s,g.ok=a,g.equal=function(t,e,n){t!=e&&s(t,e,n,"==",g.equal)},g.notEqual=function(t,e,n){t==e&&s(t,e,n,"!=",g.notEqual)},g.deepEqual=function(t,e,n){c(t,e)||s(t,e,n,"deepEqual",g.deepEqual)},g.notDeepEqual=function(t,e,n){c(t,e)&&s(t,e,n,"notDeepEqual",g.notDeepEqual)},g.strictEqual=function(t,e,n){t!==e&&s(t,e,n,"===",g.strictEqual)},g.notStrictEqual=function(t,e,n){t===e&&s(t,e,n,"!==",g.notStrictEqual)},g["throws"]=function(t,e,n){p.apply(this,[!0].concat(d.call(arguments)))},g.doesNotThrow=function(t,e){p.apply(this,[!1].concat(d.call(arguments)))},g.ifError=function(t){if(t)throw t};var y=Object.keys||function(t){var e=[];for(var n in t)m.call(t,n)&&e.push(n);return e}},{"util/":21}],4:[function(t,e,n){function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);var i=typeof t;if("base64"===e&&"string"===i)for(t=N(t);t.length%4!==0;)t+="=";var o;if("number"===i)o=L(t);else if("string"===i)o=r.byteLength(t,e);else{if("object"!==i)throw new Error("First argument needs to be a number, array or string.");o=L(t.length)}var s;r._useTypedArrays?s=r._augment(new Uint8Array(o)):(s=this,s.length=o,s._isBuffer=!0);var a;if(r._useTypedArrays&&"number"==typeof t.byteLength)s._set(t);else if(I(t))for(a=0;o>a;a++)s[a]=r.isBuffer(t)?t.readUInt8(a):t[a];else if("string"===i)s.write(t,0,e);else if("number"===i&&!r._useTypedArrays&&!n)for(a=0;o>a;a++)s[a]=0;return s}function i(t,e,n,i){n=Number(n)||0;var o=t.length-n;i?(i=Number(i),i>o&&(i=o)):i=o;var s=e.length;J(s%2===0,"Invalid hex string"),i>s/2&&(i=s/2);for(var a=0;i>a;a++){var c=parseInt(e.substr(2*a,2),16);J(!isNaN(c),"Invalid hex string"),t[n+a]=c}return r._charsWritten=2*a,a}function o(t,e,n,i){var o=r._charsWritten=R(D(e),t,n,i);return o}function s(t,e,n,i){var o=r._charsWritten=R(P(e),t,n,i);return o}function a(t,e,n,r){return s(t,e,n,r)}function c(t,e,n,i){var o=r._charsWritten=R(M(e),t,n,i);return o}function u(t,e,n,i){var o=r._charsWritten=R(B(e),t,n,i);return o}function l(t,e,n){return X.fromByteArray(0===e&&n===t.length?t:t.slice(e,n))}function h(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)t[o]<=127?(r+=z(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+z(i)}function p(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(t[i]);return r}function f(t,e,n){return p(t,e,n)}function d(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;n>o;o++)i+=T(t[o]);return i}function m(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function g(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return n?(o=t[e],i>e+1&&(o|=t[e+1]<<8)):(o=t[e]<<8,i>e+1&&(o|=t[e+1])),o}}function y(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return n?(i>e+2&&(o=t[e+2]<<16),i>e+1&&(o|=t[e+1]<<8),o|=t[e],i>e+3&&(o+=t[e+3]<<24>>>0)):(i>e+1&&(o=t[e+1]<<16),i>e+2&&(o|=t[e+2]<<8),i>e+3&&(o|=t[e+3]),o+=t[e]<<24>>>0),o}}function v(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=g(t,e,n,!0),s=32768&o;return s?-1*(65535-o+1):o}}function b(t,e,n,r){r||(J("boolean"==typeof n,"missing or invalid endian"),J(void 0!==e&&null!==e,"missing offset"),J(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=y(t,e,n,!0),s=2147483648&o;return s?-1*(4294967295-o+1):o}}function w(t,e,n,r){return r||(J("boolean"==typeof n,"missing or invalid endian"),J(e+3<t.length,"Trying to read beyond buffer length")),H.read(t,e,n,23,4)}function x(t,e,n,r){return r||(J("boolean"==typeof n,"missing or invalid endian"),J(e+7<t.length,"Trying to read beyond buffer length")),H.read(t,e,n,52,8)}function _(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+1<t.length,"trying to write beyond buffer length"),U(e,65535));var o=t.length;if(!(n>=o))for(var s=0,a=Math.min(o-n,2);a>s;s++)t[n+s]=(e&255<<8*(r?s:1-s))>>>8*(r?s:1-s)}function S(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+3<t.length,"trying to write beyond buffer length"),U(e,4294967295));var o=t.length;if(!(n>=o))for(var s=0,a=Math.min(o-n,4);a>s;s++)t[n+s]=e>>>8*(r?s:3-s)&255}function E(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+1<t.length,"Trying to write beyond buffer length"),q(e,32767,-32768));var o=t.length;n>=o||(e>=0?_(t,e,n,r,i):_(t,65535+e+1,n,r,i))}function k(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+3<t.length,"Trying to write beyond buffer length"),q(e,2147483647,-2147483648));var o=t.length;n>=o||(e>=0?S(t,e,n,r,i):S(t,4294967295+e+1,n,r,i))}function A(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+3<t.length,"Trying to write beyond buffer length"),F(e,3.4028234663852886e38,-3.4028234663852886e38));var o=t.length;n>=o||H.write(t,e,n,r,23,4)}function C(t,e,n,r,i){i||(J(void 0!==e&&null!==e,"missing value"),J("boolean"==typeof r,"missing or invalid endian"),J(void 0!==n&&null!==n,"missing offset"),J(n+7<t.length,"Trying to write beyond buffer length"),F(e,1.7976931348623157e308,-1.7976931348623157e308));var o=t.length;n>=o||H.write(t,e,n,r,52,8)}function N(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function j(t,e,n){return"number"!=typeof t?n:(t=~~t,t>=e?e:t>=0?t:(t+=e,t>=0?t:0))}function L(t){return t=~~Math.ceil(+t),0>t?0:t}function O(t){return(Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)})(t)}function I(t){return O(t)||r.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function T(t){return 16>t?"0"+t.toString(16):t.toString(16)}function D(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(127>=r)e.push(t.charCodeAt(n));else{var i=n;r>=55296&&57343>=r&&n++;for(var o=encodeURIComponent(t.slice(i,n+1)).substr(1).split("%"),s=0;s<o.length;s++)e.push(parseInt(o[s],16))}}return e}function P(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function B(t){for(var e,n,r,i=[],o=0;o<t.length;o++)e=t.charCodeAt(o),n=e>>8,r=e%256,i.push(r),i.push(n);return i}function M(t){return X.toByteArray(t)}function R(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function z(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function U(t,e){J("number"==typeof t,"cannot write a non-number as a number"),J(t>=0,"specified a negative value for writing an unsigned value"),J(e>=t,"value is larger than maximum value for type"),J(Math.floor(t)===t,"value has a fractional component")}function q(t,e,n){J("number"==typeof t,"cannot write a non-number as a number"),J(e>=t,"value larger than maximum allowed value"),J(t>=n,"value smaller than minimum allowed value"),J(Math.floor(t)===t,"value has a fractional component")}function F(t,e,n){J("number"==typeof t,"cannot write a non-number as a number"),J(e>=t,"value larger than maximum allowed value"),J(t>=n,"value smaller than minimum allowed value")}function J(t,e){if(!t)throw new Error(e||"Failed assertion")}var X=t("base64-js"),H=t("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192,r._useTypedArrays=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray}catch(n){return!1}}(),r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.isBuffer=function(t){return!(null===t||void 0===t||!t._isBuffer)},r.byteLength=function(t,e){var n;switch(t+="",e||"utf8"){case"hex":n=t.length/2;break;case"utf8":case"utf-8":n=D(t).length;break;case"ascii":case"binary":case"raw":n=t.length;break;case"base64":n=M(t).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;default:throw new Error("Unknown encoding")}return n},r.concat=function(t,e){if(J(O(t),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===t.length)return new r(0);if(1===t.length)return t[0];var n;if("number"!=typeof e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var i=new r(e),o=0;for(n=0;n<t.length;n++){var s=t[n];s.copy(i,o),o+=s.length}return i},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var l=r;r=e,e=n,n=l}e=Number(e)||0;var h=this.length-e;n?(n=Number(n),n>h&&(n=h)):n=h,r=String(r||"utf8").toLowerCase();var p;switch(r){case"hex":p=i(this,t,e,n);break;case"utf8":case"utf-8":p=o(this,t,e,n);break;case"ascii":p=s(this,t,e,n);break;case"binary":p=a(this,t,e,n);break;case"base64":p=c(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":p=u(this,t,e,n);break;default:throw new Error("Unknown encoding")}return p},r.prototype.toString=function(t,e,n){var r=this;if(t=String(t||"utf8").toLowerCase(),e=Number(e)||0,n=void 0!==n?Number(n):n=r.length,n===e)return"";var i;switch(t){case"hex":i=d(r,e,n);break;case"utf8":case"utf-8":i=h(r,e,n);break;case"ascii":i=p(r,e,n);break;case"binary":i=f(r,e,n);break;case"base64":i=l(r,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=m(r,e,n);break;default:throw new Error("Unknown encoding")}return i},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.copy=function(t,e,n,i){var o=this;if(n||(n=0),i||0===i||(i=this.length),e||(e=0),i!==n&&0!==t.length&&0!==o.length){J(i>=n,"sourceEnd < sourceStart"),J(e>=0&&e<t.length,"targetStart out of bounds"),J(n>=0&&n<o.length,"sourceStart out of bounds"),J(i>=0&&i<=o.length,"sourceEnd out of bounds"),i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var s=i-n;if(100>s||!r._useTypedArrays)for(var a=0;s>a;a++)t[a+e]=this[a+n];else t._set(this.subarray(n,n+s),e)}},r.prototype.slice=function(t,e){var n=this.length;if(t=j(t,n,0),e=j(e,n,n),r._useTypedArrays)return r._augment(this.subarray(t,e));for(var i=e-t,o=new r(i,void 0,!0),s=0;i>s;s++)o[s]=this[s+t];return o},r.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},r.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},r.prototype.readUInt8=function(t,e){return e||(J(void 0!==t&&null!==t,"missing offset"),J(t<this.length,"Trying to read beyond buffer length")),t>=this.length?void 0:this[t]},r.prototype.readUInt16LE=function(t,e){return g(this,t,!0,e)},r.prototype.readUInt16BE=function(t,e){return g(this,t,!1,e)},r.prototype.readUInt32LE=function(t,e){return y(this,t,!0,e)},r.prototype.readUInt32BE=function(t,e){return y(this,t,!1,e)},r.prototype.readInt8=function(t,e){if(e||(J(void 0!==t&&null!==t,"missing offset"),J(t<this.length,"Trying to read beyond buffer length")),!(t>=this.length)){var n=128&this[t];return n?-1*(255-this[t]+1):this[t]}},r.prototype.readInt16LE=function(t,e){return v(this,t,!0,e)},r.prototype.readInt16BE=function(t,e){return v(this,t,!1,e)},r.prototype.readInt32LE=function(t,e){return b(this,t,!0,e)},r.prototype.readInt32BE=function(t,e){return b(this,t,!1,e)},r.prototype.readFloatLE=function(t,e){return w(this,t,!0,e)},r.prototype.readFloatBE=function(t,e){return w(this,t,!1,e)},r.prototype.readDoubleLE=function(t,e){return x(this,t,!0,e)},r.prototype.readDoubleBE=function(t,e){return x(this,t,!1,e)},r.prototype.writeUInt8=function(t,e,n){n||(J(void 0!==t&&null!==t,"missing value"),J(void 0!==e&&null!==e,"missing offset"),J(e<this.length,"trying to write beyond buffer length"),U(t,255)),e>=this.length||(this[e]=t)},r.prototype.writeUInt16LE=function(t,e,n){_(this,t,e,!0,n)},r.prototype.writeUInt16BE=function(t,e,n){_(this,t,e,!1,n)},r.prototype.writeUInt32LE=function(t,e,n){S(this,t,e,!0,n)},r.prototype.writeUInt32BE=function(t,e,n){S(this,t,e,!1,n)},r.prototype.writeInt8=function(t,e,n){n||(J(void 0!==t&&null!==t,"missing value"),J(void 0!==e&&null!==e,"missing offset"),J(e<this.length,"Trying to write beyond buffer length"),q(t,127,-128)),e>=this.length||(t>=0?this.writeUInt8(t,e,n):this.writeUInt8(255+t+1,e,n))},r.prototype.writeInt16LE=function(t,e,n){E(this,t,e,!0,n)},r.prototype.writeInt16BE=function(t,e,n){E(this,t,e,!1,n)},r.prototype.writeInt32LE=function(t,e,n){k(this,t,e,!0,n)},r.prototype.writeInt32BE=function(t,e,n){k(this,t,e,!1,n)},r.prototype.writeFloatLE=function(t,e,n){A(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){A(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){C(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){C(this,t,e,!1,n)},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),"string"==typeof t&&(t=t.charCodeAt(0)),J("number"==typeof t&&!isNaN(t),"value is not a number"),J(n>=e,"end < start"),n!==e&&0!==this.length){J(e>=0&&e<this.length,"start out of bounds"),J(n>=0&&n<=this.length,"end out of bounds");for(var r=e;n>r;r++)this[r]=t}},r.prototype.inspect=function(){for(var t=[],e=this.length,r=0;e>r;r++)if(t[r]=T(this[r]),r===n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<Buffer "+t.join(" ")+">"},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r._useTypedArrays)return new r(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;n>e;e+=1)t[e]=this[e];return t.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var Y=r.prototype;r._augment=function(t){return t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=Y.get,t.set=Y.set,t.write=Y.write,t.toString=Y.toString,t.toLocaleString=Y.toString,t.toJSON=Y.toJSON,t.copy=Y.copy,t.slice=Y.slice,t.readUInt8=Y.readUInt8,t.readUInt16LE=Y.readUInt16LE,t.readUInt16BE=Y.readUInt16BE,t.readUInt32LE=Y.readUInt32LE,t.readUInt32BE=Y.readUInt32BE,t.readInt8=Y.readInt8,t.readInt16LE=Y.readInt16LE,t.readInt16BE=Y.readInt16BE,t.readInt32LE=Y.readInt32LE,t.readInt32BE=Y.readInt32BE,t.readFloatLE=Y.readFloatLE,t.readFloatBE=Y.readFloatBE,t.readDoubleLE=Y.readDoubleLE,t.readDoubleBE=Y.readDoubleBE,t.writeUInt8=Y.writeUInt8,t.writeUInt16LE=Y.writeUInt16LE,t.writeUInt16BE=Y.writeUInt16BE,t.writeUInt32LE=Y.writeUInt32LE,t.writeUInt32BE=Y.writeUInt32BE,t.writeInt8=Y.writeInt8,t.writeInt16LE=Y.writeInt16LE,t.writeInt16BE=Y.writeInt16BE,t.writeInt32LE=Y.writeInt32LE,t.writeInt32BE=Y.writeInt32BE,t.writeFloatLE=Y.writeFloatLE,t.writeFloatBE=Y.writeFloatBE,t.writeDoubleLE=Y.writeDoubleLE,t.writeDoubleBE=Y.writeDoubleBE,t.fill=Y.fill,t.inspect=Y.inspect,t.toArrayBuffer=Y.toArrayBuffer,t}},{"base64-js":5,ieee754:6}],5:[function(t,e,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s||e===h?62:e===a||e===p?63:c>e?-1:c+10>e?e-c+26+26:l+26>e?e-l:u+26>e?e-u+26:void 0}function n(t){function n(t){u[h++]=t}var r,i,s,a,c,u;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=t.length;c="="===t.charAt(l-2)?2:"="===t.charAt(l-1)?1:0,u=new o(3*t.length/4-c),s=c>0?t.length-4:t.length;var h=0;for(r=0,i=0;s>r;r+=4,i+=3)a=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===c?(a=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&a)):1===c&&(a=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(a>>8&255),n(255&a)),u}function i(t){function e(t){return r.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,s,a=t.length%3,c="";for(i=0,s=t.length-a;s>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],c+=n(o);switch(a){case 1:o=t[t.length-1],c+=e(o>>2),c+=e(o<<4&63),c+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],c+=e(o>>10),c+=e(o>>4&63),c+=e(o<<2&63),c+="="}return c}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),c="0".charCodeAt(0),u="a".charCodeAt(0),l="A".charCodeAt(0),h="-".charCodeAt(0),p="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=i}("undefined"==typeof n?this.base64js={}:n)},{}],6:[function(t,e,n){n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?i-1:0,p=n?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-l)-1,f>>=-l,l+=a;l>0;o=256*o+t[e+h],h+=p,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=r;l>0;s=256*s+t[e+h],h+=p,l-=8);if(0===o)o=1-u;else{if(o===c)return s?0/0:(f?-1:1)*(1/0);s+=Math.pow(2,r),o-=u}return(f?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,c,u=8*o-i-1,l=(1<<u)-1,h=l>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,m=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=l):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),e+=s+h>=1?p/c:p*Math.pow(2,1-h),e*c>=2&&(s++,c/=2),s+h>=l?(a=0,s=l):s+h>=1?(a=(e*c-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[n+f]=255&s,f+=d,s/=256,u-=8);t[n+f-d]|=128*m}},{}],7:[function(t,e,n){function r(t,e){if(t.length%a!==0){var n=t.length+(a-t.length%a);t=s.concat([t,c],n)}for(var r=[],i=e?t.readInt32BE:t.readInt32LE,o=0;o<t.length;o+=a)r.push(i.call(t,o));return r}function i(t,e,n){for(var r=new s(e),i=n?r.writeInt32BE:r.writeInt32LE,o=0;o<t.length;o++)i.call(r,t[o],4*o,!0);return r}function o(t,e,n,o){s.isBuffer(t)||(t=new s(t));var a=e(r(t,o),t.length*u);return i(a,n,o)}var s=t("buffer").Buffer,a=4,c=new s(a);c.fill(0);var u=8;e.exports={hash:o}},{buffer:4}],8:[function(t,e,n){function r(t,e,n){a.isBuffer(e)||(e=new a(e)),a.isBuffer(n)||(n=new a(n)),e.length>f?e=t(e):e.length<f&&(e=a.concat([e,d],f));for(var r=new a(f),i=new a(f),o=0;f>o;o++)r[o]=54^e[o],i[o]=92^e[o];var s=t(a.concat([r,n]));return t(a.concat([i,s]))}function i(t,e){t=t||"sha1";var n=p[t],i=[],s=0;return n||o("algorithm:",t,"is not yet supported"),{update:function(t){return a.isBuffer(t)||(t=new a(t)),i.push(t),s+=t.length,this},digest:function(t){var o=a.concat(i),s=e?r(n,e,o):n(o);return i=null,t?s.toString(t):s}}}function o(){var t=[].slice.call(arguments).join(" ");throw new Error([t,"we accept pull requests","http://github.com/dominictarr/crypto-browserify"].join("\n"))}function s(t,e){for(var n in t)e(t[n],n)}var a=t("buffer").Buffer,c=t("./sha"),u=t("./sha256"),l=t("./rng"),h=t("./md5"),p={sha1:c,sha256:u,md5:h},f=64,d=new a(f);d.fill(0),n.createHash=function(t){return i(t)},n.createHmac=function(t,e){return i(t,e)},n.randomBytes=function(t,e){if(!e||!e.call)return new a(l(t));try{e.call(this,void 0,new a(l(t)))}catch(n){e(n)}},s(["createCredentials","createCipher","createCipheriv","createDecipher","createDecipheriv","createSign","createVerify","createDiffieHellman","pbkdf2"],function(t){n[t]=function(){o("sorry,",t,"is not implemented yet")}})},{"./md5":9,"./rng":10,"./sha":11,"./sha256":12,buffer:4}],9:[function(t,e,n){function r(t,e){t[e>>5]|=128<<e%32,t[(e+64>>>9<<4)+14]=e;for(var n=1732584193,r=-271733879,i=-1732584194,l=271733878,h=0;h<t.length;h+=16){var p=n,f=r,d=i,m=l;n=o(n,r,i,l,t[h+0],7,-680876936),l=o(l,n,r,i,t[h+1],12,-389564586),i=o(i,l,n,r,t[h+2],17,606105819),r=o(r,i,l,n,t[h+3],22,-1044525330),n=o(n,r,i,l,t[h+4],7,-176418897),l=o(l,n,r,i,t[h+5],12,1200080426),i=o(i,l,n,r,t[h+6],17,-1473231341),r=o(r,i,l,n,t[h+7],22,-45705983),n=o(n,r,i,l,t[h+8],7,1770035416),l=o(l,n,r,i,t[h+9],12,-1958414417),i=o(i,l,n,r,t[h+10],17,-42063),r=o(r,i,l,n,t[h+11],22,-1990404162),n=o(n,r,i,l,t[h+12],7,1804603682),l=o(l,n,r,i,t[h+13],12,-40341101),i=o(i,l,n,r,t[h+14],17,-1502002290),r=o(r,i,l,n,t[h+15],22,1236535329),n=s(n,r,i,l,t[h+1],5,-165796510),l=s(l,n,r,i,t[h+6],9,-1069501632),i=s(i,l,n,r,t[h+11],14,643717713),r=s(r,i,l,n,t[h+0],20,-373897302),n=s(n,r,i,l,t[h+5],5,-701558691),l=s(l,n,r,i,t[h+10],9,38016083),i=s(i,l,n,r,t[h+15],14,-660478335),r=s(r,i,l,n,t[h+4],20,-405537848),n=s(n,r,i,l,t[h+9],5,568446438),l=s(l,n,r,i,t[h+14],9,-1019803690),i=s(i,l,n,r,t[h+3],14,-187363961),r=s(r,i,l,n,t[h+8],20,1163531501),n=s(n,r,i,l,t[h+13],5,-1444681467),l=s(l,n,r,i,t[h+2],9,-51403784),i=s(i,l,n,r,t[h+7],14,1735328473),r=s(r,i,l,n,t[h+12],20,-1926607734),n=a(n,r,i,l,t[h+5],4,-378558),l=a(l,n,r,i,t[h+8],11,-2022574463),i=a(i,l,n,r,t[h+11],16,1839030562),r=a(r,i,l,n,t[h+14],23,-35309556),n=a(n,r,i,l,t[h+1],4,-1530992060),l=a(l,n,r,i,t[h+4],11,1272893353),i=a(i,l,n,r,t[h+7],16,-155497632),r=a(r,i,l,n,t[h+10],23,-1094730640),n=a(n,r,i,l,t[h+13],4,681279174),l=a(l,n,r,i,t[h+0],11,-358537222),i=a(i,l,n,r,t[h+3],16,-722521979),r=a(r,i,l,n,t[h+6],23,76029189),n=a(n,r,i,l,t[h+9],4,-640364487),l=a(l,n,r,i,t[h+12],11,-421815835),i=a(i,l,n,r,t[h+15],16,530742520),r=a(r,i,l,n,t[h+2],23,-995338651),n=c(n,r,i,l,t[h+0],6,-198630844),l=c(l,n,r,i,t[h+7],10,1126891415),i=c(i,l,n,r,t[h+14],15,-1416354905),r=c(r,i,l,n,t[h+5],21,-57434055),n=c(n,r,i,l,t[h+12],6,1700485571),l=c(l,n,r,i,t[h+3],10,-1894986606),i=c(i,l,n,r,t[h+10],15,-1051523),r=c(r,i,l,n,t[h+1],21,-2054922799),n=c(n,r,i,l,t[h+8],6,1873313359),l=c(l,n,r,i,t[h+15],10,-30611744),i=c(i,l,n,r,t[h+6],15,-1560198380),r=c(r,i,l,n,t[h+13],21,1309151649),n=c(n,r,i,l,t[h+4],6,-145523070),l=c(l,n,r,i,t[h+11],10,-1120210379),i=c(i,l,n,r,t[h+2],15,718787259),r=c(r,i,l,n,t[h+9],21,-343485551),n=u(n,p),r=u(r,f),i=u(i,d),l=u(l,m)}return Array(n,r,i,l)}function i(t,e,n,r,i,o){return u(l(u(u(e,t),u(r,o)),i),n)}function o(t,e,n,r,o,s,a){return i(e&n|~e&r,t,e,o,s,a)}function s(t,e,n,r,o,s,a){return i(e&r|n&~r,t,e,o,s,a)}function a(t,e,n,r,o,s,a){return i(e^n^r,t,e,o,s,a)}function c(t,e,n,r,o,s,a){return i(n^(e|~r),t,e,o,s,a)}function u(t,e){var n=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(n>>16);return r<<16|65535&n}function l(t,e){return t<<e|t>>>32-e}var h=t("./helpers");e.exports=function(t){return h.hash(t,r,16)}},{"./helpers":7}],10:[function(t,e,n){!function(){var t,n,r=this;t=function(t){for(var e,e,n=new Array(t),r=0;t>r;r++)0==(3&r)&&(e=4294967296*Math.random()),n[r]=e>>>((3&r)<<3)&255;return n},r.crypto&&crypto.getRandomValues&&(n=function(t){var e=new Uint8Array(t);return crypto.getRandomValues(e),e}),e.exports=n||t}()},{}],11:[function(t,e,n){function r(t,e){t[e>>5]|=128<<24-e%32,t[(e+64>>9<<4)+15]=e;for(var n=Array(80),r=1732584193,c=-271733879,u=-1732584194,l=271733878,h=-1009589776,p=0;p<t.length;p+=16){for(var f=r,d=c,m=u,g=l,y=h,v=0;80>v;v++){n[v]=16>v?t[p+v]:a(n[v-3]^n[v-8]^n[v-14]^n[v-16],1);var b=s(s(a(r,5),i(v,c,u,l)),s(s(h,n[v]),o(v)));h=l,l=u,u=a(c,30),c=r,r=b}r=s(r,f),c=s(c,d),u=s(u,m),l=s(l,g),h=s(h,y)}return Array(r,c,u,l,h)}function i(t,e,n,r){return 20>t?e&n|~e&r:40>t?e^n^r:60>t?e&n|e&r|n&r:e^n^r}function o(t){return 20>t?1518500249:40>t?1859775393:60>t?-1894007588:-899497514}function s(t,e){var n=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(n>>16);return r<<16|65535&n}function a(t,e){return t<<e|t>>>32-e}var c=t("./helpers");e.exports=function(t){return c.hash(t,r,20,!0)}},{"./helpers":7}],12:[function(t,e,n){var r=t("./helpers"),i=function(t,e){var n=(65535&t)+(65535&e),r=(t>>16)+(e>>16)+(n>>16);return r<<16|65535&n},o=function(t,e){return t>>>e|t<<32-e},s=function(t,e){return t>>>e},a=function(t,e,n){return t&e^~t&n},c=function(t,e,n){return t&e^t&n^e&n},u=function(t){return o(t,2)^o(t,13)^o(t,22)},l=function(t){return o(t,6)^o(t,11)^o(t,25)},h=function(t){return o(t,7)^o(t,18)^s(t,3)},p=function(t){return o(t,17)^o(t,19)^s(t,10)},f=function(t,e){var n,r,o,s,f,d,m,g,y,v,b,w,x=new Array(1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298),_=new Array(1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225),S=new Array(64);t[e>>5]|=128<<24-e%32,t[(e+64>>9<<4)+15]=e;for(var y=0;y<t.length;y+=16){n=_[0],r=_[1],o=_[2],s=_[3],f=_[4],d=_[5],m=_[6],g=_[7];for(var v=0;64>v;v++)S[v]=16>v?t[v+y]:i(i(i(p(S[v-2]),S[v-7]),h(S[v-15])),S[v-16]),b=i(i(i(i(g,l(f)),a(f,d,m)),x[v]),S[v]),w=i(u(n),c(n,r,o)),g=m,m=d,d=f,f=i(s,b),s=o,o=r,r=n,n=i(b,w);_[0]=i(n,_[0]),_[1]=i(r,_[1]),_[2]=i(o,_[2]),_[3]=i(s,_[3]),_[4]=i(f,_[4]),_[5]=i(d,_[5]),_[6]=i(m,_[6]),_[7]=i(g,_[7])}return _};e.exports=function(t){return r.hash(t,f,32,!0)}},{"./helpers":7}],13:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!o(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,o,c,u;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.');

}if(n=this._events[t],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),c=1;r>c;c++)o[c-1]=arguments[c];n.apply(this,o)}else if(s(n)){for(r=arguments.length,o=new Array(r-1),c=1;r>c;c++)o[c-1]=arguments[c];for(u=n.slice(),r=u.length,c=0;r>c;c++)u[c].apply(this,o)}return!0},r.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned){var n;n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,o,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],o=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=o;a-->0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?i(t._events[e])?1:t._events[e].length:0}},{}],14:[function(t,e,n){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],15:[function(t,e,n){(function(t){function e(t,e){for(var n=0,r=t.length-1;r>=0;r--){var i=t[r];"."===i?t.splice(r,1):".."===i?(t.splice(r,1),n++):n&&(t.splice(r,1),n--)}if(e)for(;n--;n)t.unshift("..");return t}function r(t,e){if(t.filter)return t.filter(e);for(var n=[],r=0;r<t.length;r++)e(t[r],r,t)&&n.push(t[r]);return n}var i=/^(\/?|)([\s\S]*?)((?:\.{1,2}|[^\/]+?|)(\.[^.\/]*|))(?:[\/]*)$/,o=function(t){return i.exec(t).slice(1)};n.resolve=function(){for(var n="",i=!1,o=arguments.length-1;o>=-1&&!i;o--){var s=o>=0?arguments[o]:t.cwd();if("string"!=typeof s)throw new TypeError("Arguments to path.resolve must be strings");s&&(n=s+"/"+n,i="/"===s.charAt(0))}return n=e(r(n.split("/"),function(t){return!!t}),!i).join("/"),(i?"/":"")+n||"."},n.normalize=function(t){var i=n.isAbsolute(t),o="/"===s(t,-1);return t=e(r(t.split("/"),function(t){return!!t}),!i).join("/"),t||i||(t="."),t&&o&&(t+="/"),(i?"/":"")+t},n.isAbsolute=function(t){return"/"===t.charAt(0)},n.join=function(){var t=Array.prototype.slice.call(arguments,0);return n.normalize(r(t,function(t,e){if("string"!=typeof t)throw new TypeError("Arguments to path.join must be strings");return t}).join("/"))},n.relative=function(t,e){function r(t){for(var e=0;e<t.length&&""===t[e];e++);for(var n=t.length-1;n>=0&&""===t[n];n--);return e>n?[]:t.slice(e,n-e+1)}t=n.resolve(t).substr(1),e=n.resolve(e).substr(1);for(var i=r(t.split("/")),o=r(e.split("/")),s=Math.min(i.length,o.length),a=s,c=0;s>c;c++)if(i[c]!==o[c]){a=c;break}for(var u=[],c=a;c<i.length;c++)u.push("..");return u=u.concat(o.slice(a)),u.join("/")},n.sep="/",n.delimiter=":",n.dirname=function(t){var e=o(t),n=e[0],r=e[1];return n||r?(r&&(r=r.substr(0,r.length-1)),n+r):"."},n.basename=function(t,e){var n=o(t)[2];return e&&n.substr(-1*e.length)===e&&(n=n.substr(0,n.length-e.length)),n},n.extname=function(t){return o(t)[3]};var s="b"==="ab".substr(-1)?function(t,e,n){return t.substr(e,n)}:function(t,e,n){return 0>e&&(e=t.length+e),t.substr(e,n)}}).call(this,t("1YiZ5S"))},{"1YiZ5S":16}],16:[function(t,e,n){function r(){}var i=e.exports={};i.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],17:[function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var c=1e3;o&&"number"==typeof o.maxKeys&&(c=o.maxKeys);var u=t.length;c>0&&u>c&&(u=c);for(var l=0;u>l;++l){var h,p,f,d,m=t[l].replace(a,"%20"),g=m.indexOf(n);g>=0?(h=m.substr(0,g),p=m.substr(g+1)):(h=m,p=""),f=decodeURIComponent(h),d=decodeURIComponent(p),r(s,f)?i(s[f])?s[f].push(d):s[f]=[s[f],d]:s[f]=d}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],18:[function(t,e,n){"use strict";function r(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?r(s(t),function(r){var s=encodeURIComponent(i(r))+n;return o(t[r])?t[r].map(function(t){return s+encodeURIComponent(i(t))}).join(e):s+encodeURIComponent(i(t[r]))}).join(e):a?encodeURIComponent(i(a))+n+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],19:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":17,"./encode":18}],20:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],21:[function(t,e,n){(function(e,r){function i(t,e){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(e)?r.showHidden=e:e&&n._extend(r,e),x(r.showHidden)&&(r.showHidden=!1),x(r.depth)&&(r.depth=2),x(r.colors)&&(r.colors=!1),x(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),c(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function c(t,e,r){if(t.customInspect&&e&&A(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return b(i)||(i=c(t,i,r)),i}var o=u(t,e);if(o)return o;var s=Object.keys(e),m=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),k(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(e);if(0===s.length){if(A(e)){var g=e.name?": "+e.name:"";return t.stylize("[Function"+g+"]","special")}if(_(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(E(e))return t.stylize(Date.prototype.toString.call(e),"date");if(k(e))return l(e)}var y="",v=!1,w=["{","}"];if(d(e)&&(v=!0,w=["[","]"]),A(e)){var x=e.name?": "+e.name:"";y=" [Function"+x+"]"}if(_(e)&&(y=" "+RegExp.prototype.toString.call(e)),E(e)&&(y=" "+Date.prototype.toUTCString.call(e)),k(e)&&(y=" "+l(e)),0===s.length&&(!v||0==e.length))return w[0]+y+w[1];if(0>r)return _(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var S;return S=v?h(t,e,r,m,s):s.map(function(n){return p(t,e,r,m,n,v)}),t.seen.pop(),f(S,y,w)}function u(t,e){if(x(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return v(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i){for(var o=[],s=0,a=e.length;a>s;++s)o.push(O(e,String(s))?p(t,e,n,r,String(s),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(t,e,n,r,i,!0))}),o}function p(t,e,n,r,i,o){var s,a,u;if(u=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},u.get?a=u.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):u.set&&(a=t.stylize("[Setter]","special")),O(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(u.value)<0?(a=g(n)?c(t,u.value,null):c(t,u.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),x(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function f(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return null==t}function v(t){return"number"==typeof t}function b(t){return"string"==typeof t}function w(t){return"symbol"==typeof t}function x(t){return void 0===t}function _(t){return S(t)&&"[object RegExp]"===N(t)}function S(t){return"object"==typeof t&&null!==t}function E(t){return S(t)&&"[object Date]"===N(t)}function k(t){return S(t)&&("[object Error]"===N(t)||t instanceof Error)}function A(t){return"function"==typeof t}function C(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function N(t){return Object.prototype.toString.call(t)}function j(t){return 10>t?"0"+t.toString(10):t.toString(10)}function L(){var t=new Date,e=[j(t.getHours()),j(t.getMinutes()),j(t.getSeconds())].join(":");return[t.getDate(),P[t.getMonth()],e].join(" ")}function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var I=/%[sdj%]/g;n.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(t).replace(I,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),a=r[n];o>n;a=r[++n])s+=g(a)||!S(a)?" "+a:" "+i(a);return s},n.deprecate=function(t,i){function o(){if(!s){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),s=!0}return t.apply(this,arguments)}if(x(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return o};var T,D={};n.debuglog=function(t){if(x(T)&&(T=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!D[t])if(new RegExp("\\b"+t+"\\b","i").test(T)){var r=e.pid;D[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else D[t]=function(){};return D[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=m,n.isNull=g,n.isNullOrUndefined=y,n.isNumber=v,n.isString=b,n.isSymbol=w,n.isUndefined=x,n.isRegExp=_,n.isObject=S,n.isDate=E,n.isError=k,n.isFunction=A,n.isPrimitive=C,n.isBuffer=t("./support/isBuffer");var P=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",L(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!S(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("1YiZ5S"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":20,"1YiZ5S":16,inherits:14}],22:[function(t,e,n){"use strict";function r(t,e){o.call(this,t,e),this.nodeType=1,this.nodeName=this.localName}var i=t("util"),o=t("./element").Element;i.inherits(r,o),r.prototype._getElement=function(t,e){var n=new r(t,e);return n},Object.defineProperty(r.prototype,"localName",{get:function(){return this.getName()}}),Object.defineProperty(r.prototype,"namespaceURI",{get:function(){return this.getNS()}}),Object.defineProperty(r.prototype,"parentNode",{get:function(){return this.parent}}),Object.defineProperty(r.prototype,"childNodes",{get:function(){return this.children}}),Object.defineProperty(r.prototype,"textContent",{get:function(){return this.getText()},set:function(t){this.children.push(t)}}),r.prototype.getElementsByTagName=function(t){return this.getChildren(t)},r.prototype.getAttribute=function(t){return this.getAttr(t)},r.prototype.setAttribute=function(t,e){this.attr(t,e)},r.prototype.getAttributeNS=function(t,e){return"http://www.w3.org/XML/1998/namespace"===t?this.getAttr(["xml",e].join(":")):this.getAttr(e,t)},r.prototype.setAttributeNS=function(t,e,n){var r;if("http://www.w3.org/XML/1998/namespace"===t)r="xml";else{var i=this.getXmlns();r=i[t]||""}r&&this.attr([r,e].join(":"),n)},r.prototype.removeAttribute=function(t){this.attr(t,null)},r.prototype.removeAttributeNS=function(t,e){var n;if("http://www.w3.org/XML/1998/namespace"===t)n="xml";else{var r=this.getXmlns();n=r[t]||""}n&&this.attr([n,e].join(":"),null)},r.prototype.appendChild=function(t){this.cnode(t)},r.prototype.removeChild=function(t){this.remove(t)},e.exports=r},{"./element":23,util:21}],23:[function(t,e,n){"use strict";function r(t,e){this.name=t,this.parent=null,this.children=[],this.setAttrs(e)}function i(t){return t.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/"/g,"&apos;")}function o(t){return t.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}r.prototype.is=function(t,e){return this.getName()===t&&(!e||this.getNS()===e)},r.prototype.getName=function(){return this.name.indexOf(":")>=0?this.name.substr(this.name.indexOf(":")+1):this.name},r.prototype.getNS=function(){if(this.name.indexOf(":")>=0){var t=this.name.substr(0,this.name.indexOf(":"));return this.findNS(t)}return this.findNS()},r.prototype.findNS=function(t){if(t){var e="xmlns:"+t;if(this.attrs[e])return this.attrs[e];if(this.parent)return this.parent.findNS(t)}else{if(this.attrs.xmlns)return this.attrs.xmlns;if(this.parent)return this.parent.findNS()}},r.prototype.getXmlns=function(){var t={};this.parent&&(t=this.parent.getXmlns());for(var e in this.attrs){var n=e.match("xmlns:?(.*)");this.attrs.hasOwnProperty(e)&&n&&(t[this.attrs[e]]=n[1])}return t},r.prototype.setAttrs=function(t){this.attrs={},Object.keys(t||{}).forEach(function(e){this.attrs[e]=t[e]},this)},r.prototype.getAttr=function(t,e){if(!e)return this.attrs[t];var n=this.getXmlns();return n[e]?this.attrs[[n[e],t].join(":")]:null},r.prototype.getChild=function(t,e){return this.getChildren(t,e)[0]},r.prototype.getChildren=function(t,e){for(var n=[],r=0;r<this.children.length;r++){var i=this.children[r];!i.getName||i.getName()!==t||e&&i.getNS()!==e||n.push(i)}return n},r.prototype.getChildByAttr=function(t,e,n,r){return this.getChildrenByAttr(t,e,n,r)[0]},r.prototype.getChildrenByAttr=function(t,e,n,r){for(var i=[],o=0;o<this.children.length;o++){var s=this.children[o];!s.attrs||s.attrs[t]!==e||n&&s.getNS()!==n||i.push(s),r&&s.getChildrenByAttr&&i.push(s.getChildrenByAttr(t,e,n,!0))}return r&&(i=[].concat.apply([],i)),i},r.prototype.getChildrenByFilter=function(t,e){for(var n=[],r=0;r<this.children.length;r++){var i=this.children[r];t(i)&&n.push(i),e&&i.getChildrenByFilter&&n.push(i.getChildrenByFilter(t,!0))}return e&&(n=[].concat.apply([],n)),n},r.prototype.getText=function(){for(var t="",e=0;e<this.children.length;e++){var n=this.children[e];("string"==typeof n||"number"==typeof n)&&(t+=n)}return t},r.prototype.getChildText=function(t,e){var n=this.getChild(t,e);return n?n.getText():null},r.prototype.getChildElements=function(){return this.getChildrenByFilter(function(t){return t instanceof r})},r.prototype.root=function(){return this.parent?this.parent.root():this},r.prototype.tree=r.prototype.root,r.prototype.up=function(){return this.parent?this.parent:this},r.prototype._getElement=function(t,e){var n=new r(t,e);return n},r.prototype.c=function(t,e){return this.cnode(this._getElement(t,e))},r.prototype.cnode=function(t){return this.children.push(t),t.parent=this,t},r.prototype.t=function(t){return this.children.push(t),this},r.prototype.remove=function(t,e){var n;return n="string"==typeof t?function(n){return!(n.is&&n.is(t,e))}:function(e){return e!==t},this.children=this.children.filter(n),this},r.prototype.clone=function(){for(var t=this._getElement(this.name,this.attrs),e=0;e<this.children.length;e++){var n=this.children[e];t.cnode(n.clone?n.clone():n)}return t},r.prototype.text=function(t){return t&&1===this.children.length?(this.children[0]=t,this):this.getText()},r.prototype.attr=function(t,e){return"undefined"!=typeof e||null===e?(this.attrs||(this.attrs={}),this.attrs[t]=e,this):this.attrs[t]},r.prototype.toString=function(){var t="";return this.write(function(e){t+=e}),t},r.prototype.toJSON=function(){return{name:this.name,attrs:this.attrs,children:this.children.map(function(t){return t&&t.toJSON?t.toJSON():t})}},r.prototype._addChildren=function(t){t(">");for(var e=0;e<this.children.length;e++){var n=this.children[e];(n||0===n)&&(n.write?n.write(t):"string"==typeof n?t(o(n)):n.toString&&t(o(n.toString(10))))}t("</"),t(this.name),t(">")},r.prototype.write=function(t){t("<"),t(this.name);for(var e in this.attrs){var n=this.attrs[e];(n||""===n||0===n)&&(t(" "),t(e),t('="'),"string"!=typeof n&&(n=n.toString(10)),t(i(n)),t('"'))}0===this.children.length?t("/>"):this._addChildren(t)},n.Element=r,n.escapeXml=i},{}],24:[function(t,e,n){"use strict";var r=t("./parse");r.availableSaxParsers.push(r.bestSaxParser=t("./sax/sax_ltx")),e.exports=t("./index")},{"./index":25,"./parse":26,"./sax/sax_ltx":27}],25:[function(t,e,n){"use strict";var r=t("./parse");n.Element=t("./dom-element"),n.escapeXml=t("./element").escapeXml,n.parse=r.parse,n.Parser=r.Parser,n.availableSaxParsers=r.availableSaxParsers,n.bestSaxParser=r.bestSaxParser},{"./dom-element":22,"./element":23,"./parse":26}],26:[function(t,e,n){"use strict";var r=t("events"),i=t("util"),o=t("./dom-element");n.availableSaxParsers=[],n.bestSaxParser=null;var s=["./sax/sax_expat.js","./sax/sax_ltx.js","./sax/sax_saxjs.js"];s.forEach(function(e){var r;try{r=t(e)}catch(i){}r&&(n.availableSaxParsers.push(r),n.bestSaxParser||(n.bestSaxParser=r))}),n.Parser=function(t){r.EventEmitter.call(this);var e=this,i=t||n.bestSaxParser;if(!i)throw new Error("No SAX parser available");this.parser=new i;var s;this.parser.addListener("startElement",function(t,e){var n=new o(t,e);s=s?s.cnode(n):n}),this.parser.addListener("endElement",function(t){s&&t===s.name&&(s.parent?s=s.parent:e.tree||(e.tree=s,s=void 0))}),this.parser.addListener("text",function(t){s&&s.t(t)}),this.parser.addListener("error",function(t){e.error=t,e.emit("error",t)})},i.inherits(n.Parser,r.EventEmitter),n.Parser.prototype.write=function(t){this.parser.write(t)},n.Parser.prototype.end=function(t){this.parser.end(t),this.error||(this.tree?this.emit("tree",this.tree):this.emit("error",new Error("Incomplete document")))},n.parse=function(t,e){var r=new n.Parser(e),i=null,o=null;if(r.on("tree",function(t){i=t}),r.on("error",function(t){o=t}),r.write(t),r.end(),o)throw o;return i}},{"./dom-element":22,events:13,util:21}],27:[function(t,e,n){"use strict";function r(t){return t.replace(/\&(amp|#38);/g,"&").replace(/\&(lt|#60);/g,"<").replace(/\&(gt|#62);/g,">").replace(/\&(quot|#34);/g,'"').replace(/\&(apos|#39);/g,"'").replace(/\&(nbsp|#160);/g,"\n")}var i=t("util"),o=t("events"),s=0,a=1,c=2,u=3,l=4,h=5,p=6,f=7,d=e.exports=function(){o.EventEmitter.call(this);var t,e,n,i,d,m,g,y=s,v=0;this._handleTagOpening=function(t,e,n){t?this.emit("endElement",e):(this.emit("startElement",e,n),d&&this.emit("endElement",e))},this.write=function(o){function b(){if("number"==typeof v){var t=o.slice(v,w);return v=void 0,t}}"string"!=typeof o&&(o=o.toString());var w=0;for(t&&(o=t+o,w+=t.length,t=null);w<o.length;w++){var x=o.charCodeAt(w);switch(y){case s:if(60===x){var _=b();_&&this.emit("text",r(_)),y=c,v=w+1,n={}}break;case c:47===x&&v===w?(v=w+1,i=!0):33===x||63===x?(v=void 0,y=a):(32>=x||47===x||62===x)&&(e=b(),w--,y=u);break;case a:62===x&&(y=s);break;case u:62===x?(this._handleTagOpening(i,e,n),e=void 0,n=void 0,i=void 0,d=void 0,y=s,v=w+1):47===x?d=!0:x>32&&(v=w,y=l);break;case l:(32>=x||61===x)&&(g=b(),w--,y=h);break;case h:61===x&&(y=p);break;case p:(34===x||39===x)&&(m=x,y=f,v=w+1);break;case f:if(x===m){var S=r(b());n[g]=S,g=void 0,y=u}}}"number"==typeof v&&v<=o.length&&(t=o.slice(v),v=0)}};i.inherits(d,o.EventEmitter),d.prototype.end=function(t){t&&this.write(t),this.write=function(){}}},{events:13,util:21}],28:[function(t,e,n){(function(n){"use strict";function r(t){this.options={},t&&(this.options=t),this.availableSaslMechanisms=[d,m,g,f,p,h],this.options.autostart!==!1&&this.connect()}var i,o,s,a=t("./lib/session"),c=(t("node-xmpp-core").Connection,t("node-xmpp-core").JID),u=t("node-xmpp-core").Stanza,l=t("./lib/sasl"),h=t("./lib/authentication/anonymous"),p=t("./lib/authentication/plain"),f=t("./lib/authentication/digestmd5"),d=t("./lib/authentication/xoauth2"),m=t("./lib/authentication/xfacebook"),g=t("./lib/authentication/external"),y=t("child_process").exec,v=t("util"),b=t("debug")("xmpp:client"),w=t("node-xmpp-core").ltx,x="jabber:client",_="jabber:iq:register",S="urn:ietf:params:xml:ns:xmpp-sasl",E="urn:ietf:params:xml:ns:xmpp-bind",k="urn:ietf:params:xml:ns:xmpp-session",A=0,C=1,N=2,j=3,L=4,O=5,I="sess",T="bind";if("undefined"==typeof D)var D=null,P=null;"function"==typeof D?i=function(t){return P(t)}:(s=t("buffer").Buffer,i=function(t){return new s(t,"base64").toString("utf8")}),"function"==typeof P?o=function(t){return D(t)}:(s=t("buffer").Buffer,o=function(t){return new s(t,"utf8").toString("base64")}),v.inherits(r,a),r.NS_CLIENT=x,r.prototype.connect=function(){if(this.options.bosh&&this.options.bosh.prebind){b("load bosh prebind");var t=this.options.bosh.prebind;delete this.options.bosh.prebind;var e="node "+n+"/lib/prebind.js ";delete this.options.bosh.prebind,e+=encodeURI(JSON.stringify(this.options)),y(e,function(e,n,r){if(e)t(e,null);else{var i=n.match(/rid:+[ 0-9]*/i);i=i[0].split(":")[1].trim();var o=n.match(/sid:+[ a-z+'"-_A-Z+0-9]*/i);if(o=o[0].split(":")[1].replace("'","").replace("'","").trim(),i&&o)return t(null,{rid:i,sid:o});t(r)}})}else{this.options.xmlns=x,delete this.did_bind,delete this.did_session,this.state=A,this.on("end",function(){this.state=A,delete this.did_bind,delete this.did_session}),a.call(this,this.options),this.options.jid=this.jid,this.connection.on("disconnect",function(t){this.state=A,this.connection.reconnect||(t&&this.emit("error",t),this.emit("offline")),delete this.did_bind,delete this.did_session}.bind(this)),this.preferredSaslMechanism=this.options.preferred?this.options.preferred:"DIGEST-MD5";var r=l.detectMechanisms(this.options,this.availableSaslMechanisms);this.availableSaslMechanisms=r}},r.prototype.onStanza=function(t){this.state!==O&&t.is("features")?(this.streamFeatures=t,this.useFeatures()):this.state===A?this.emit("stanza:preauth",t):this.state===C?this._handleAuthState(t):this.state===j&&t.is("iq")&&t.attrs.id===T?this._handleBindState(t):this.state===L&&!0===t.is("iq")&&t.attrs.id===I?this._handleSessionState(t):"stream:error"===t.name?this.reconnect||this.emit("error",t):this.state===O&&this.emit("stanza",t)},r.prototype._handleSessionState=function(t){"result"===t.attrs.type?(this.state=N,this.did_session=!0,this.useFeatures()):this.emit("error","Cannot bind resource")},r.prototype._handleBindState=function(t){if("result"===t.attrs.type){this.state=N,this.did_bind=!0;var e=t.getChild("bind",E);e&&e.getChild("jid")&&(this.jid=new c(e.getChild("jid").getText())),this.useFeatures()}else this.emit("error","Cannot bind resource")},r.prototype._handleAuthState=function(t){if(t.is("challenge",S)){var e=i(t.getText()),n=o(this.mech.challenge(e)),r=new u.Element("response",{xmlns:S}).t(n);this.send(r)}else t.is("success",S)?(this.mech=null,this.state=N,this.emit("auth")):this.emit("error","XMPP authentication failure")},r.prototype._handlePreAuthState=function(){this.state=C;var t=this.streamFeatures.getChild("mechanisms",S).getChildren("mechanism",S).map(function(t){return t.getText()});if(this.mech=l.selectMechanism(t,this.preferredSaslMechanism,this.availableSaslMechanisms),this.mech){this.mech.authzid=this.jid.bare().toString(),this.mech.authcid=this.jid.user,this.mech.password=this.password,this.mech.api_key=this.api_key,this.mech.access_token=this.access_token,this.mech.oauth2_token=this.oauth2_token,this.mech.oauth2_auth=this.oauth2_auth,this.mech.realm=this.jid.domain,this.actAs&&(this.mech.actAs=this.actAs.user),this.mech.digest_uri="xmpp/"+this.jid.domain;var e=o(this.mech.auth()),n=this.mech.authAttrs();n.xmlns=S,n.mechanism=this.mech.name,this.send(new u.Element("auth",n).t(e))}else this.emit("error","No usable SASL mechanism")},r.prototype.useFeatures=function(){if(this.state===A&&this.register)delete this.register,this.doRegister();else if(this.state===A&&this.streamFeatures.getChild("mechanisms",S))this._handlePreAuthState();else if(this.state===N&&!this.did_bind&&this.streamFeatures.getChild("bind",E)){this.state=j;var t=new u.Element("iq",{type:"set",id:T}).c("bind",{xmlns:E});this.jid.resource&&t.c("resource").t(this.jid.resource),this.send(t)}else if(this.state===N&&!this.did_session&&this.streamFeatures.getChild("session",k)){this.state=L;var e=new u.Element("iq",{type:"set",to:this.jid.domain,id:I}).c("session",{xmlns:k});this.send(e)}else this.state===N&&(this.state=O,this.emit("online",{jid:this.jid}))},r.prototype.doRegister=function(){var t="register"+Math.ceil(99999*Math.random()),e=new u.Element("iq",{type:"set",id:t,to:this.jid.domain}).c("query",{xmlns:_}).c("username").t(this.jid.user).up().c("password").t(this.password);this.send(e);var n=this,r=function(e){e.is("iq")&&e.attrs.id===t&&(n.removeListener("stanza",r),"result"===e.attrs.type?n.useFeatures():n.emit("error",new Error("Registration error")))};this.on("stanza:preauth",r)},r.prototype.getSaslMechanisms=function(){return this.availableSaslMechanisms},r.prototype.clearSaslMechanism=function(){this.availableSaslMechanisms=[]},r.prototype.registerSaslMechanism=function(t){-1===this.availableSaslMechanisms.indexOf(t)&&this.availableSaslMechanisms.push(t)},r.prototype.unregisterSaslMechanism=function(t){var e=this.availableSaslMechanisms.indexOf(t);e>=0&&(this.availableSaslMechanisms=this.availableSaslMechanisms.splice(e,1))},r.SASL=l,r.Client=r,r.Stanza=u,r.ltx=w,e.exports=r}).call(this,"/../node_modules/node-xmpp-client")},{"./lib/authentication/anonymous":29,"./lib/authentication/digestmd5":30,"./lib/authentication/external":31,"./lib/authentication/plain":33,"./lib/authentication/xfacebook":34,"./lib/authentication/xoauth2":35,"./lib/sasl":37,"./lib/session":38,buffer:4,child_process:2,debug:41,"node-xmpp-core":44,util:21}],29:[function(t,e,n){"use strict";function r(){}var i=t("util"),o=t("./mechanism");i.inherits(r,o),r.prototype.name="ANONYMOUS",r.prototype.auth=function(){return this.authzid},r.prototype.match=function(){return!0},e.exports=r},{"./mechanism":32,util:21}],30:[function(t,e,n){"use strict";function r(t,e){var n=h.createHash("md5");return n.update(t),n.digest(e||"binary")}function i(t){return r(t,"hex")}function o(t){for(var e={};t;){var n;(n=/^(.+?)=(.*?[^\\]),\s*(.*)/.exec(t))?(e[n[1]]=n[2].replace(/\"/g,""),t=n[3]):(n=/^(.+?)=(.+?),\s*(.*)/.exec(t))?(e[n[1]]=n[2],t=n[3]):(n=/^(.+?)="(.*?[^\\])"$/.exec(t))?(e[n[1]]=n[2],t=n[3]):(n=/^(.+?)=(.+?)$/.exec(t))?(e[n[1]]=n[2],t=n[3]):t=null}return e}function s(t){var e="";for(var n in t){var r=t[n];r&&(e+=","+n+'="'+r+'"')}return e.substr(1)}function a(t,e,n){for(;t.length<e;)t=n+t;return t}function c(){for(var t="",e=0;8>e;e++)t+=String.fromCharCode(48+Math.ceil(10*Math.random()));return t}function u(){this.nonce_count=0,this.cnonce=c(),this.authcid=null,this.actAs=null,this.realm=null,this.password=null}var l=t("util"),h=t("crypto"),p=t("./mechanism");l.inherits(u,p),u.prototype.name="DIGEST-MD5",u.prototype.auth=function(){return""},u.prototype.getNC=function(){return a(this.nonce_count.toString(),8,"0")},u.prototype.responseValue=function(t){var e=o(t);e.realm&&(this.realm=e.realm);var n;if(e.nonce&&e.qop){this.nonce_count++;var s=r(this.authcid+":"+this.realm+":"+this.password)+":"+e.nonce+":"+this.cnonce;this.actAs&&(s+=":"+this.actAs);var a="AUTHENTICATE:"+this.digest_uri;("auth-int"===e.qop||"auth-conf"===e.qop)&&(a+=":00000000000000000000000000000000"),n=i(i(s)+":"+e.nonce+":"+this.getNC()+":"+this.cnonce+":"+e.qop+":"+i(a))}return n},u.prototype.challenge=function(t){var e=o(t);e.realm&&(this.realm=e.realm);var n;if(e.nonce&&e.qop){var r=this.responseValue(t);n={username:this.authcid,realm:this.realm,nonce:e.nonce,cnonce:this.cnonce,nc:this.getNC(),qop:e.qop,"digest-uri":this.digest_uri,response:r,charset:"utf-8"},this.actAs&&(n.authzid=this.actAs)}else if(e.rspauth)return"";return s(n)},u.prototype.serverChallenge=function(){var t={};return t.realm="",this.nonce=t.nonce=c(),t.qop="auth",this.charset=t.charset="utf-8",t.algorithm="md5-sess",s(t)},u.prototype.response=function(t){var e=o(t);return this.authcid=e.username,e.nonce!==this.nonce?!1:e.cnonce?(this.cnonce=e.cnonce,this.charset!==e.charset?!1:(this.response=e.response,!0)):!1},u.prototype.match=function(t){return t.password?!0:!1},e.exports=u},{"./mechanism":32,crypto:8,util:21}],31:[function(t,e,n){"use strict";function r(){}var i=t("util"),o=t("./mechanism");i.inherits(r,o),r.prototype.name="EXTERNAL",r.prototype.auth=function(){return this.authzid},r.prototype.match=function(t){
return t.credentials?!0:!1},e.exports=r},{"./mechanism":32,util:21}],32:[function(t,e,n){"use strict";function r(){}var i=t("util"),o=t("events").EventEmitter;i.inherits(r,o),r.prototype.authAttrs=function(){return{}},e.exports=r},{events:13,util:21}],33:[function(t,e,n){"use strict";function r(){}var i=t("util"),o=t("./mechanism");i.inherits(r,o),r.prototype.name="PLAIN",r.prototype.auth=function(){return this.authzid+"\x00"+this.authcid+"\x00"+this.password},r.prototype.match=function(t){return t.password?!0:!1},e.exports=r},{"./mechanism":32,util:21}],34:[function(t,e,n){"use strict";var r=t("util"),i=t("./mechanism"),o=t("querystring"),s=function(){};r.inherits(s,i),s.prototype.name="X-FACEBOOK-PLATFORM",s.prototype.host="chat.facebook.com",s.prototype.auth=function(){return""},s.prototype.challenge=function(t){var e=o.parse(t),n={api_key:this.api_key,call_id:(new Date).getTime(),method:e.method,nonce:e.nonce,access_token:this.access_token,v:"1.0"};return o.stringify(n)},s.prototype.match=function(t){var e=s.prototype.host;return t.host===e||t.jid&&t.jid.getDomain()===e?!0:!1},e.exports=s},{"./mechanism":32,querystring:19,util:21}],35:[function(t,e,n){"use strict";function r(){this.oauth2_auth=null,this.authzid=null}var i=t("util"),o=t("./mechanism");i.inherits(r,o),r.prototype.name="X-OAUTH2",r.prototype.NS_GOOGLE_AUTH="http://www.google.com/talk/protocol/auth",r.prototype.auth=function(){return"\x00"+this.authzid+"\x00"+this.oauth2_token},r.prototype.authAttrs=function(){return{"auth:service":"oauth2","xmlns:auth":this.oauth2_auth}},r.prototype.match=function(t){return t.oauth2_auth===r.prototype.NS_GOOGLE_AUTH},e.exports=r},{"./mechanism":32,util:21}],36:[function(t,e,n){(function(n){"use strict";function r(t){var e=this;if(i.call(this),this.boshURL=t.bosh.url,this.jid=t.jid,this.wait=t.bosh.wait||10,this.xmlnsAttrs={xmlns:"http://jabber.org/protocol/httpbind","xmlns:xmpp":"urn:xmpp:xbosh","xmlns:stream":"http://etherx.jabber.org/streams"},t.xmlns)for(var r in t.xmlns)r?this.xmlnsAttrs["xmlns:"+r]=t.xmlns[r]:this.xmlnsAttrs.xmlns=t.xmlns[r];this.currentRequests=0,this.queue=[],this.rid=Math.ceil(9999999999*Math.random()),this.request({to:this.jid.domain,ver:"1.6",wait:this.wait,hold:"1",content:this.contentType,"xmpp:version":"1.0"},[],function(t,r){t?e.emit("error",t):r&&r.attrs&&(e.sid=r.attrs.sid,e.maxRequests=parseInt(r.attrs.requests,10)||2,e.sid&&e.maxRequests>0?(e.emit("connect"),e.processResponse(r),n.nextTick(e.mayRequest.bind(e))):e.emit("error","Invalid parameters"))})}var i=t("events").EventEmitter,o=t("util"),s=t("request"),a=t("node-xmpp-core").ltx,c=t("debug")("xmpp:client:bosh");o.inherits(r,i),r.prototype.contentType="text/xml; charset=utf-8",r.prototype.send=function(t){this.queue.push(t.root()),n.nextTick(this.mayRequest.bind(this))},r.prototype.startStream=function(){var t=this;this.rid++,this.request({to:this.jid.domain,"xmpp:restart":"true"},[],function(e,r){e?(t.emit("error",e),t.emit("disconnect"),t.emit("end"),delete t.sid,t.emit("close")):(t.streamOpened=!0,r&&t.processResponse(r),n.nextTick(t.mayRequest.bind(t)))})},r.prototype.processResponse=function(t){if(c("process bosh server response "+t.toString()),t&&t.children)for(var e=0;e<t.children.length;e++){var n=t.children[e];n.name&&n.attrs&&n.children&&this.emit("stanza",n)}t&&"terminate"===t.attrs.type&&((!this.shutdown||t.attrs.condition)&&this.emit("error",new Error(t.attrs.condition||"Session terminated")),this.emit("disconnect"),this.emit("end"),this.emit("close"))},r.prototype.mayRequest=function(){var t=this.sid&&(0===this.currentRequests||this.queue.length>0&&this.currentRequests<this.maxRequests);if(t){var e=this.queue;this.queue=[],this.rid++,this.request({},e,function(t,e){t?(this.emit("error",t),this.emit("disconnect"),this.emit("end"),delete this.sid,this.emit("close")):(e&&this.processResponse(e),n.nextTick(this.mayRequest.bind(this)))}.bind(this))}},r.prototype.end=function(t){t=t||[],typeof t!==Array&&(t=[t]),t=this.queue.concat(t),this.shutdown=!0,this.queue=[],this.rid++,this.request({type:"terminate"},t,function(t,e){e&&this.processResponse(e),this.emit("disconnect"),this.emit("end"),delete this.sid,this.emit("close")}.bind(this))},r.prototype.maxHTTPRetries=5,r.prototype.request=function(t,e,n,r){var i=this;r=r||0,t.rid=this.rid.toString(),this.sid&&(t.sid=this.sid);for(var o in this.xmlnsAttrs)t[o]=this.xmlnsAttrs[o];for(var u=new a.Element("body",t),l=0;l<e.length;l++)u.cnode(e[l]);c("send bosh request:"+u.toString()),s({uri:this.boshURL,method:"POST",headers:{"Content-Type":this.contentType},body:u.toString()},function(o,s,c){if(i.currentRequests--,o)return r<i.maxHTTPRetries?i.request(t,e,n,r+1):n(o);if(s.statusCode<200||s.statusCode>=400)return n(new Error("HTTP status "+s.statusCode));var u;try{u=a.parse(c)}catch(l){return n(l)}u&&"terminate"===u.attrs.type&&u.attrs.condition?n(new Error(u.attrs.condition)):u?n(null,u):n(new Error("no <body/>"))}),this.currentRequests++},e.exports=r}).call(this,t("1YiZ5S"))},{"1YiZ5S":16,debug:41,events:13,"node-xmpp-core":44,request:40,util:21}],37:[function(t,e,n){"use strict";function r(t,e,n){var r,i=[],o={};return Array.isArray(n)&&(i=i.concat(n)),i.forEach(function(t){o[t.prototype.name]=t}),o[e]&&t.indexOf(e)>=0&&(r=o[e]),i.forEach(function(e){!r&&t.indexOf(e.prototype.name)>=0&&(r=e)}),r?new r:null}function i(t,e){var n=e?e:[],r=[];return n.forEach(function(e){var n=e.prototype.match;n(t)&&r.push(e)}),r}var o=t("./authentication/mechanism");n.selectMechanism=r,n.detectMechanisms=i,n.AbstractMechanism=o},{"./authentication/mechanism":32}],38:[function(t,e,n){(function(n){"use strict";function r(t){a.call(this),this.setOptions(t),t.websocket&&t.websocket.url?(f("start websocket connection"),this._setupWebsocketConnection(t)):t.bosh&&t.bosh.url?(f("start bosh connection"),this._setupBoshConnection(t)):(f("start socket connection"),this._setupSocketConnection(t))}var i=t("util"),o=t("tls"),s=t("crypto"),a=t("events").EventEmitter,c=t("node-xmpp-core").Connection,u=t("node-xmpp-core").JID,l=t("node-xmpp-core").SRV,h=t("./bosh"),p=t("./websockets"),f=t("debug")("xmpp:client:session");i.inherits(r,a),r.prototype._setupSocketConnection=function(t){var e={xmlns:{"":t.xmlns},streamAttrs:{version:"1.0",to:this.jid.domain},serialized:t.serialized};for(var n in t)n in e||(e[n]=t[n]);if(this.connection=new c(e),this._addConnectionListeners(),t.host)this._socketConnectionToHost(t);else{if(!l)throw"Cannot load SRV";this._performSrvLookup(t)}},r.prototype._socketConnectionToHost=function(t){t.legacySSL?(this.connection.allowTLS=!1,this.connection.connect({socket:function(){return o.connect(t.port||5223,t.host,t.credentials||{},function(){this.socket.authorized?this.emit("connect",this.socket):this.emit("error","unauthorized")}.bind(this))}})):(t.credentials&&(this.connection.credentials=s.createCredentials(t.credentials)),t.disallowTLS&&(this.connection.allowTLS=!1),this.connection.listen({socket:function(){n.nextTick(function(){this.socket.connect(t.port||5222,t.host)}.bind(this));var e=t.socket;return t.socket=null,e}}))},r.prototype._performSrvLookup=function(t){if(t.legacySSL)throw"LegacySSL mode does not support DNS lookups";t.credentials&&(this.connection.credentials=s.createCredentials(t.credentials)),t.disallowTLS&&(this.connection.allowTLS=!1),this.connection.listen({socket:l.connect({socket:t.socket,services:["_xmpp-client._tcp"],domain:this.jid.domain,defaultPort:5222})})},r.prototype._setupBoshConnection=function(t){this.connection=new h({jid:this.jid,bosh:t.bosh}),this._addConnectionListeners(),this.connection.on("connected",function(){this.connection.startStream&&this.connection.startStream()}.bind(this))},r.prototype._setupWebsocketConnection=function(t){this.connection=new p({jid:this.jid,websocket:t.websocket}),this._addConnectionListeners(),this.connection.on("connected",function(){this.connection.startStream&&this.connection.startStream()}.bind(this))},r.prototype.setOptions=function(t){this.jid="string"==typeof t.jid?new u(t.jid):t.jid,this.password=t.password,this.preferredSaslMechanism=t.preferredSaslMechanism,this.api_key=t.api_key,this.access_token=t.access_token,this.oauth2_token=t.oauth2_token,this.oauth2_auth=t.oauth2_auth,this.register=t.register,this.actAs="string"==typeof t.actAs?new u(t.actAs):t.actAs},r.prototype._addConnectionListeners=function(t){t=t||this.connection,t.on("stanza",this.onStanza.bind(this)),t.on("drain",this.emit.bind(this,"drain")),t.on("end",this.emit.bind(this,"end")),t.on("close",this.emit.bind(this,"close")),t.on("error",this.emit.bind(this,"error")),t.on("connect",this.emit.bind(this,"connect")),t.on("reconnect",this.emit.bind(this,"reconnect")),t.on("disconnect",this.emit.bind(this,"disconnect")),t.startStream&&(t.on("connect",function(){t.startStream()}),this.on("auth",function(){t.startStream()}))},r.prototype.pause=function(){this.connection&&this.connection.pause&&this.connection.pause()},r.prototype.resume=function(){this.connection&&this.connection.resume&&this.connection.resume()},r.prototype.send=function(t){return this.connection?this.connection.send(t):!1},r.prototype.end=function(){this.connection&&this.connection.end()},r.prototype.onStanza=function(){},e.exports=r}).call(this,t("1YiZ5S"))},{"./bosh":36,"./websockets":39,"1YiZ5S":16,crypto:8,debug:41,events:13,"node-xmpp-core":44,tls:2,util:21}],39:[function(t,e,n){"use strict";function r(t){i.call(this),this.url=t.websocket.url,this.jid=t.jid,this.xmlns={},this.websocket=new c(this.url,["xmpp"]),this.websocket.onopen=this.onopen.bind(this),this.websocket.onmessage=this.onmessage.bind(this),this.websocket.onclose=this.onclose.bind(this),this.websocket.onerror=this.onerror.bind(this)}var i=t("events").EventEmitter,o=t("util"),s=t("node-xmpp-core").ltx,a=t("node-xmpp-core").StreamParser,c=t("faye-websocket")&&t("faye-websocket").Client?t("faye-websocket").Client:window.WebSocket,u=t("node-xmpp-core").Connection,l=t("debug")("xmpp:client:websockets");o.inherits(r,i),r.prototype.maxStanzaSize=65535,r.prototype.xmppVersion="1.0",r.prototype.onopen=function(){this.startParser(),this.emit("connected")},r.prototype.startParser=function(){var t=this;this.parser=new a.StreamParser(this.maxStanzaSize),this.parser.on("start",function(e){t.streamAttrs=e,t.streamNsAttrs={};for(var n in e)("xmlns"===n||"xmlns:"===n.substr(0,6))&&(t.streamNsAttrs[n]=e[n]);t.emit("streamStart",e)}),this.parser.on("stanza",function(e){t.onStanza(e)}),this.parser.on("error",this.onerror.bind(this)),this.parser.on("end",function(){t.stopParser(),t.end()})},r.prototype.stopParser=function(){this.parser&&delete this.parser},r.prototype.onmessage=function(t){l("ws msg <--",t.data),t&&t.data&&this.parser&&this.parser.write(t.data)},r.prototype.onStanza=function(t){t.is("error",u.NS_STREAM)?this.emit("error",t):this.emit("stanza",t)},r.prototype.startStream=function(){var t={};for(var e in this.xmlns)this.xmlns.hasOwnProperty(e)&&(e?t["xmlns:"+e]=this.xmlns[e]:t.xmlns=this.xmlns[e]);this.xmppVersion&&(t.version=this.xmppVersion),this.streamTo&&(t.to=this.streamTo),this.streamId&&(t.id=this.streamId),this.jid&&(t.to=this.jid.domain),t.xmlns="jabber:client",t["xmlns:stream"]=u.NS_STREAM;var n=new s.Element("stream:stream",t);n.t(" ");var r=n.toString();this.send(r.substr(0,r.indexOf(" </stream:stream>"))),this.streamOpened=!0},r.prototype.send=function(t){t.root&&(t=t.root()),t=t.toString(),l("ws send -->",t),this.websocket.send(t)},r.prototype.onclose=function(){this.emit("disconnect"),this.emit("close")},r.prototype.end=function(){this.send("</stream:stream>"),this.emit("disconnect"),this.emit("end"),this.websocket&&this.websocket.close()},r.prototype.onerror=function(t){this.emit("error",t)},e.exports=r},{debug:41,events:13,"faye-websocket":2,"node-xmpp-core":44,util:21}],40:[function(t,e,n){!function(t,r){"function"==typeof define&&define.amd?define([],r):"object"==typeof n?e.exports=r():t.returnExports=r()}(this,function(){function t(i,o){if("function"!=typeof o)throw new Error("Bad callback given: "+o);if(!i)throw new Error("No options given");var a=i.onResponse;if(i="string"==typeof i?{uri:i}:JSON.parse(JSON.stringify(i)),i.onResponse=a,i.verbose&&(t.log=r()),i.url&&(i.uri=i.url,delete i.url),!i.uri&&""!==i.uri)throw new Error("options.uri is a required argument");if("string"!=typeof i.uri)throw new Error("options.uri must be a string");for(var c=["proxy","_redirectsFollowed","maxRedirects","followRedirect"],u=0;u<c.length;u++)if(i[c[u]])throw new Error("options."+c[u]+" is not supported");if(i.callback=o,i.method=i.method||"GET",i.headers=i.headers||{},i.body=i.body||null,i.timeout=i.timeout||t.DEFAULT_TIMEOUT,i.headers.host)throw new Error("Options.headers.host is not supported");i.json&&(i.headers.accept=i.headers.accept||"application/json","GET"!==i.method&&(i.headers["content-type"]="application/json"),"boolean"!=typeof i.json?i.body=JSON.stringify(i.json):"string"!=typeof i.body&&(i.body=JSON.stringify(i.body)));var l=function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(encodeURIComponent(n)+"="+encodeURIComponent(t[n]));return e.join("&")};if(i.qs){var h="string"==typeof i.qs?i.qs:l(i.qs);i.uri=-1!==i.uri.indexOf("?")?i.uri+"&"+h:i.uri+"?"+h}var p=function(t){var e={};e.boundry="-------------------------------"+Math.floor(1e9*Math.random());var n=[];for(var r in t)t.hasOwnProperty(r)&&n.push("--"+e.boundry+'\nContent-Disposition: form-data; name="'+r+'"\n\n'+t[r]+"\n");return n.push("--"+e.boundry+"--"),e.body=n.join(""),e.length=e.body.length,e.type="multipart/form-data; boundary="+e.boundry,e};if(i.form){if("string"==typeof i.form)throw"form name unsupported";if("POST"===i.method){var f=(i.encoding||"application/x-www-form-urlencoded").toLowerCase();switch(i.headers["content-type"]=f,f){case"application/x-www-form-urlencoded":i.body=l(i.form).replace(/%20/g,"+");break;case"multipart/form-data":var d=p(i.form);i.body=d.body,i.headers["content-type"]=d.type;break;default:throw new Error("unsupported encoding:"+f)}}}return i.onResponse=i.onResponse||n,i.onResponse===!0&&(i.onResponse=o,i.callback=n),!i.headers.authorization&&i.auth&&(i.headers.authorization="Basic "+s(i.auth.username+":"+i.auth.password)),e(i)}function e(e){function n(){h=!0;var n=new Error("ETIMEDOUT");return n.code="ETIMEDOUT",n.duration=e.timeout,t.log.error("Timeout",{id:l._id,milliseconds:e.timeout}),e.callback(n,l)}function r(n){if(h)return t.log.debug("Ignoring timed out state change",{state:l.readyState,id:l.id});if(t.log.debug("State change",{state:l.readyState,id:l.id,timed_out:h}),l.readyState===a.OPENED){t.log.debug("Request started",{id:l.id});for(var r in e.headers)l.setRequestHeader(r,e.headers[r])}else l.readyState===a.HEADERS_RECEIVED?i():l.readyState===a.LOADING?(i(),s()):l.readyState===a.DONE&&(i(),s(),c())}function i(){if(!m.response){if(m.response=!0,t.log.debug("Got response",{id:l.id,status:l.status}),clearTimeout(l.timeoutTimer),l.statusCode=l.status,p&&0==l.statusCode){var n=new Error("CORS request rejected: "+e.uri);return n.cors="rejected",m.loading=!0,m.end=!0,e.callback(n,l)}e.onResponse(null,l)}}function s(){m.loading||(m.loading=!0,t.log.debug("Response body loading",{id:l.id}))}function c(){if(!m.end){if(m.end=!0,t.log.debug("Request done",{id:l.id}),l.body=l.responseText,e.json)try{l.body=JSON.parse(l.responseText)}catch(n){return e.callback(n,l)}e.callback(null,l,l.body)}}var l=new a,h=!1,p=o(e.uri),f="withCredentials"in l;if(u+=1,l.seq_id=u,l.id=u+": "+e.method+" "+e.uri,l._id=l.id,p&&!f){var d=new Error("Browser does not support cross-origin request: "+e.uri);return d.cors="unsupported",e.callback(d,l)}l.timeoutTimer=setTimeout(n,e.timeout);var m={response:!1,loading:!1,end:!1};return l.onreadystatechange=r,l.open(e.method,e.uri,!0),p&&(l.withCredentials=!!e.withCredentials),l.send(e.body),l}function n(){}function r(){var t,e,r={},o=["trace","debug","info","warn","error"];for(e=0;e<o.length;e++)t=o[e],r[t]=n,"undefined"!=typeof console&&console&&console[t]&&(r[t]=i(console,t));return r}function i(t,e){function n(n,r){return"object"==typeof r&&(n+=" "+JSON.stringify(r)),t[e].call(t,n)}return n}function o(t){var e,n=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+))?)?/;try{e=location.href}catch(r){e=document.createElement("a"),e.href="",e=e.href}var i=n.exec(e.toLowerCase())||[],o=n.exec(t.toLowerCase()),s=!(!o||o[1]==i[1]&&o[2]==i[2]&&(o[3]||("http:"===o[1]?80:443))==(i[3]||("http:"===i[1]?80:443)));return s}function s(t){var e,n,r,i,o,s,a,c,u="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",l=0,h=0,p="",f=[];if(!t)return t;do e=t.charCodeAt(l++),n=t.charCodeAt(l++),r=t.charCodeAt(l++),c=e<<16|n<<8|r,i=c>>18&63,o=c>>12&63,s=c>>6&63,a=63&c,f[h++]=u.charAt(i)+u.charAt(o)+u.charAt(s)+u.charAt(a);while(l<t.length);switch(p=f.join(""),t.length%3){case 1:p=p.slice(0,-2)+"==";break;case 2:p=p.slice(0,-1)+"="}return p}var a=XMLHttpRequest;if(!a)throw new Error("missing XMLHttpRequest");t.log={trace:n,debug:n,info:n,warn:n,error:n};var c=18e4,u=0;t.withCredentials=!1,t.DEFAULT_TIMEOUT=c,t.defaults=function(e,n){var r=function(t){var n=function(n,r){n="string"==typeof n?{uri:n}:JSON.parse(JSON.stringify(n));for(var i in e)void 0===n[i]&&(n[i]=e[i]);return t(n,r)};return n},i=r(t);return i.get=r(t.get),i.post=r(t.post),i.put=r(t.put),i.head=r(t.head),i};var l=["get","put","post","head"];return l.forEach(function(e){var n=e.toUpperCase(),r=e.toLowerCase();t[r]=function(e){"string"==typeof e?e={method:n,uri:e}:(e=JSON.parse(JSON.stringify(e)),e.method=n);var r=[e].concat(Array.prototype.slice.apply(arguments,[1]));return t.apply(this,r)}}),t.couch=function(e,r){function i(t,e,n){if(t)return r(t,e,n);if((e.statusCode<200||e.statusCode>299)&&n.error){t=new Error("CouchDB error: "+(n.error.reason||n.error.error));for(var i in n)t[i]=n[i];return r(t,e,n)}return r(t,e,n)}"string"==typeof e&&(e={uri:e}),e.json=!0,e.body&&(e.json=e.body),delete e.body,r=r||n;var o=t(e,i);return o},t})},{}],41:[function(t,e,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+n.humanize(this.diff),!e)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var i=0,o=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))}),t.splice(o,0,r),t}function o(){return"object"==typeof console&&"function"==typeof console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?localStorage.removeItem("debug"):localStorage.debug=t}catch(e){}}function a(){var t;try{t=localStorage.debug}catch(e){}return t}n=e.exports=t("./debug"),n.log=o,n.formatArgs=i,n.save=s,n.load=a,n.useColors=r,n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(t){return JSON.stringify(t)},n.enable(a())},{"./debug":42}],42:[function(t,e,n){function r(){return n.colors[l++%n.colors.length]}function i(t){function e(){}function i(){var t=i,e=+new Date,o=e-(u||e);t.diff=o,t.prev=u,t.curr=e,u=e,null==t.useColors&&(t.useColors=n.useColors()),null==t.color&&t.useColors&&(t.color=r());var s=Array.prototype.slice.call(arguments);s[0]=n.coerce(s[0]),"string"!=typeof s[0]&&(s=["%o"].concat(s));var a=0;s[0]=s[0].replace(/%([a-z%])/g,function(e,r){if("%%"===e)return e;a++;var i=n.formatters[r];if("function"==typeof i){var o=s[a];e=i.call(t,o),s.splice(a,1),a--}return e}),"function"==typeof n.formatArgs&&(s=n.formatArgs.apply(t,s));var c=i.log||n.log||console.log.bind(console);c.apply(t,s)}e.enabled=!1,i.enabled=!0;var o=n.enabled(t)?i:e;return o.namespace=t,o}function o(t){n.save(t);for(var e=(t||"").split(/[\s,]+/),r=e.length,i=0;r>i;i++)e[i]&&(t=e[i].replace(/\*/g,".*?"),"-"===t[0]?n.skips.push(new RegExp("^"+t.substr(1)+"$")):n.names.push(new RegExp("^"+t+"$")))}function s(){n.enable("")}function a(t){var e,r;for(e=0,r=n.skips.length;r>e;e++)if(n.skips[e].test(t))return!1;for(e=0,r=n.names.length;r>e;e++)if(n.names[e].test(t))return!0;return!1}function c(t){return t instanceof Error?t.stack||t.message:t}n=e.exports=i,n.coerce=c,n.disable=s,n.enable=o,n.enabled=a,n.humanize=t("ms"),n.names=[],n.skips=[],n.formatters={};var u,l=0},{ms:43}],43:[function(t,e,n){function r(t){var e=/^((?:\d+)?\.?\d+) *(ms|seconds?|s|minutes?|m|hours?|h|days?|d|years?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"y":return n*h;case"days":case"day":case"d":return n*l;case"hours":case"hour":case"h":return n*u;case"minutes":case"minute":case"m":return n*c;case"seconds":case"second":case"s":return n*a;case"ms":return n}}}function i(t){return t>=l?Math.round(t/l)+"d":t>=u?Math.round(t/u)+"h":t>=c?Math.round(t/c)+"m":t>=a?Math.round(t/a)+"s":t+"ms"}function o(t){return s(t,l,"day")||s(t,u,"hour")||s(t,c,"minute")||s(t,a,"second")||t+" ms"}function s(t,e,n){return e>t?void 0:1.5*e>t?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var a=1e3,c=60*a,u=60*c,l=24*u,h=365.25*l;e.exports=function(t,e){return e=e||{},"string"==typeof t?r(t):e["long"]?o(t):i(t)}},{}],44:[function(t,e,n){var r=t("util")._extend;n.Stanza={},r(n.Stanza,t("./lib/stanza")),n.JID=t("./lib/jid"),n.Connection=t("./lib/connection"),n.SRV=t("./lib/srv"),n.StreamParser=t("./lib/stream_parser"),n.ltx=t("ltx")},{"./lib/connection":45,"./lib/jid":46,"./lib/srv":47,"./lib/stanza":48,"./lib/stream_parser":49,ltx:55,util:21}],45:[function(t,e,n){"use strict";function r(t,e){var n=d({},e);return n.initialDelay=e&&(e.initialReconnectDelay||e.reconnectDelay)||v,n.maxDelay=e&&e.maxReconnectDelay||b,n.immediate=e&&e.socket&&"function"!=typeof e.socket,n.type=e&&e.delayType,n.emitter=t,n}function i(t){a.call(this),this.streamAttrs=t&&t.streamAttrs||{},this.xmlns=t&&t.xmlns||{},this.xmlns.stream=g,this.rejectUnauthorized=t&&t.rejectUnauthorized?!0:!1,this.serialized=t&&t.serialized?!0:!1,this.requestCert=t&&t.requestCert?!0:!1,this.servername=t&&t.servername,this._setupSocket(r(this,t)),this.once("reconnect",function(){this.reconnect=t&&t.reconnect})}function o(t){return t.children?t.children.reduce(function(t,e){return t+o(e)},""):t}var s=t("net"),a=t("events").EventEmitter,c=t("util"),u=t("ltx"),l=t("reconnect-core"),h=t("./stream_parser"),p=t("tls-connect"),f=t("debug")("xmpp:connection"),d=t("util")._extend,m="urn:ietf:params:xml:ns:xmpp-tls",g="http://etherx.jabber.org/streams",y="urn:ietf:params:xml:ns:xmpp-streams",v=1e3,b=3e4;c.inherits(i,a),i.prototype.NS_XMPP_TLS=m,i.NS_STREAM=g,i.prototype.NS_XMPP_STREAMS=y,i.prototype.allowTLS=!0,i.prototype._setupSocket=function(t){f("setup socket");var e={},n=l(function(t){var r=this.socket;return"on"===t.preserve?(t.preserve=e,e=t):t=e=t.preserve?t.preserve:t||e,"function"==typeof t.socket?(f("use lazy socket"),this.socket=t.socket.call(this)):(f("use standard socket"),this.socket=t.socket,t.socket=null,this.socket&&this.once("connect",function(){n.options.immediate=!1})),this.socket=this.socket||new s.Socket,r!==this.socket&&this.setupStream(),this.socket}.bind(this));n(n.options=t);var r=this.end;this.end=this.disconnect=function(){this.endStream(),r()},this.on("connection",function(){this.parser||this.startParser()}),this.on("end",function(){e={}})},i.prototype.setupStream=function(){f("setup stream"),this.socket.on("end",this.onEnd.bind(this)),this.socket.on("data",this.onData.bind(this)),this.socket.on("close",this.onClose.bind(this)),this.socket.on("data",this.emit.bind(this,"data")),this.socket.on("drain",this.emit.bind(this,"drain")),this.socket.on("error",function(){}),this.socket.serializeStanza||(this.socket.serializeStanza=this.serialized?function(t,e){t.write(function(t){e(t)})}:function(t,e){e(t.toString())})},i.prototype.pause=function(){this.socket.pause&&this.socket.pause()},i.prototype.resume=function(){this.socket.resume&&this.socket.resume()},i.prototype.send=function(t){var e=!0;if(this.socket){if(!this.socket.writable)return void this.socket.end();if(f("send: "+t.toString()),t.root){var n=this.rmXmlns(t.root());this.socket.serializeStanza(n,function(t){e=this.write(t)}.bind(this.socket))}else e=this.socket.write(t);return e}},i.prototype.startParser=function(){var t=this;this.parser=new h.StreamParser(this.maxStanzaSize),this.parser.on("streamStart",function(e){t.streamNsAttrs={};for(var n in e)("xmlns"===n||"xmlns:"===n.substr(0,6))&&(t.streamNsAttrs[n]=e[n]);t.emit("streamStart",e)}),this.parser.on("stanza",function(e){t.onStanza(t.addStreamNs(e))}),this.parser.on("error",function(e){t.error(e.condition||"internal-server-error",e.message)}),this.parser.once("end",function(){t.stopParser(),t.reconnect?t.once("reconnect",t.startParser.bind(t)):t.end()})},i.prototype.stopParser=function(){if(this.parser){var t=this.parser;this.parser=null,t.end()}},i.prototype.startStream=function(){var t={};for(var e in this.xmlns)this.xmlns.hasOwnProperty(e)&&(e?t["xmlns:"+e]=this.xmlns[e]:t.xmlns=this.xmlns[e]);for(e in this.streamAttrs)this.streamAttrs.hasOwnProperty(e)&&(t[e]=this.streamAttrs[e]);this.streamTo&&(t.to=this.streamTo);var n=new u.Element("stream:stream",t);n.t(" ");var r=n.toString();this.send(r.substr(0,r.indexOf(" </stream:stream>"))),this.streamOpened=!0},i.prototype.endStream=function(){this.socket&&this.socket.writable&&this.streamOpened&&(this.socket.write("</stream:stream>"),this.streamOpened=!1)},i.prototype.onData=function(t){f("receive: "+t.toString("utf8")),this.parser&&this.parser.write(t)},i.prototype.setSecure=function(t,e){this.socket.removeAllListeners("data"),this.socket.removeAllListeners("drain"),this.socket.removeAllListeners("close"),this.socket.clearTimer&&this.socket.clearTimer();var n=p({socket:this.socket,rejectUnauthorized:this.rejectUnauthorized,credentials:t||this.credentials,requestCert:this.requestCert,isServer:!!e},function(){this.isSecure=!0,this.once("disconnect",function(){this.isSecure=!1}),n.emit("connect",n)}.bind(this));n.on("clientError",this.emit.bind(this,"error")),this.reconnect||(this.reconnect=!0,this.once("reconnect",function(){this.reconnect=!1})),this.stopParser(),this.listen({socket:n,preserve:"on"})},i.prototype.onStanza=function(t){if(t.is("error",g)){var e=new Error(""+o(t));e.stanza=t,this.socket.emit("error",e)}else t.is("features",this.NS_STREAM)&&this.allowTLS&&!this.isSecure&&t.getChild("starttls",this.NS_XMPP_TLS)?this.send(new u.Element("starttls",{xmlns:this.NS_XMPP_TLS})):this.allowTLS&&t.is("proceed",this.NS_XMPP_TLS)?this.setSecure():this.emit("stanza",t)},i.prototype.addStreamNs=function(t){for(var e in this.streamNsAttrs)t.attrs[e]||"xmlns"===e&&this.streamNsAttrs[e]===this.xmlns[""]||(t.attrs[e]=this.streamNsAttrs[e]);return t},i.prototype.rmXmlns=function(t){for(var e in this.xmlns){var n=e?"xmlns:"+e:"xmlns";t.attrs[n]===this.xmlns[e]&&(t.attrs[n]=null)}return t},i.prototype.onEnd=function(){this.endStream(),this.reconnect||this.emit("end")},i.prototype.onClose=function(){this.reconnect||this.emit("close")},i.prototype.error=function(t,e){if(this.emit("error",new Error(e)),this.socket&&this.socket.writable){this.streamOpened||this.startStream();var n=new u.Element("stream:error");n.c(t,{xmlns:y}),e&&n.c("text",{xmlns:y,"xml:lang":"en"}).t(e),this.send(n),this.end()}},e.exports=i},{"./stream_parser":49,debug:50,events:13,ltx:55,net:2,"reconnect-core":65,"tls-connect":72,util:21}],46:[function(t,e,n){function r(t,e,n){if(this.local=null,this.domain=null,this.resource=null,!t||e||n){if(!e)throw new Error("Argument error");this.setLocal(t),this.setDomain(e),this.setResource(n)}else this.parseJID(t)}var i=t("node-stringprep").StringPrep,o=t("node-stringprep").toUnicode;r.prototype.parseJID=function(t){t.indexOf("@")>=0&&(this.setLocal(t.substr(0,t.lastIndexOf("@"))),t=t.substr(t.lastIndexOf("@")+1)),t.indexOf("/")>=0&&(this.setResource(t.substr(t.indexOf("/")+1)),t=t.substr(0,t.indexOf("/"))),this.setDomain(t)},r.prototype.toString=function(t){var e=this.domain;return this.local&&(e=this.getLocal(t)+"@"+e),this.resource&&(e=e+"/"+this.resource),e},r.prototype.bare=function(){return this.resource?new r(this.local,this.domain,null):this},r.prototype.equals=function(t){return this.local===t.local&&this.domain===t.domain&&this.resource===t.resource},r.prototype.setUser=function(t){return this.setLocal(t)},r.prototype.setLocal=function(t,e){return e=e||this.detectEscape(t),e&&(t=this.escapeLocal(t)),this.local=this.user=t&&this.prep("nodeprep",t),this},r.prototype.setDomain=function(t){return this.domain=t&&this.prep("nameprep",t.split(".").map(o).join(".")),this},r.prototype.setResource=function(t){return this.resource=t&&this.prep("resourceprep",t),this},r.prototype.getLocal=function(t){t=t||!1;var e=null;return e=t?this.unescapeLocal(this.local):this.local},r.prototype.prep=function(t,e){var n=new i(t);return n.prepare(e)},r.prototype.getUser=function(){return this.getLocal()},r.prototype.getDomain=function(){return this.domain},r.prototype.getResource=function(){return this.resource},r.prototype.detectEscape=function(t){if(!t)return!1;var e=t.replace(/\\20/g,"").replace(/\\22/g,"").replace(/\\26/g,"").replace(/\\27/g,"").replace(/\\2f/g,"").replace(/\\3a/g,"").replace(/\\3c/g,"").replace(/\\3e/g,"").replace(/\\40/g,"").replace(/\\5c/g,""),n=e.search(/\\| |\"|\&|\'|\/|:|<|>|@/g);return-1===n?!1:!0},r.prototype.escapeLocal=function(t){return null===t?null:t.replace(/^\s+|\s+$/g,"").replace(/\\/g,"\\5c").replace(/ /g,"\\20").replace(/\"/g,"\\22").replace(/\&/g,"\\26").replace(/\'/g,"\\27").replace(/\//g,"\\2f").replace(/:/g,"\\3a").replace(/</g,"\\3c").replace(/>/g,"\\3e").replace(/@/g,"\\40").replace(/\3a/g,"c3a")},r.prototype.unescapeLocal=function(t){return null===t?null:t.replace(/\\20/g," ").replace(/\\22/g,'"').replace(/\\26/g,"&").replace(/\\27/g,"'").replace(/\\2f/g,"/").replace(/\\3a/g,":").replace(/\\3c/g,"<").replace(/\\3e/g,">").replace(/\\40/g,"@").replace(/\\5c/g,"\\")},"undefined"!=typeof n&&null!==n?e.exports=r:"undefined"!=typeof window&&null!==window&&(window.JID=r)},{"node-stringprep":59}],47:[function(t,e,n){"use strict";function r(t,e){return t=parseInt(t,10),e=parseInt(e,10),e>t?-1:t>e?1:0}function i(t){var e={};t.forEach(function(t){e.hasOwnProperty(t.priority)||(e[t.priority]=[]),e[t.priority].push(t)});var n=[];return Object.keys(e).sort(r).forEach(function(t){var r=e[t],i=0;r.forEach(function(t){i+=t.weight});var o=Math.floor(Math.random()*i);i=0;var s=r[0];r.forEach(function(t){i+=t.weight,i>o&&(s=t)}),s&&n.push(s)}),n}function o(t,e){c.resolveSrv(t,function(t,n){if(t)e(t);else{var r,o=0,a=[],c=function(t,n){r=r||t,a=a.concat(n),o--,1>o&&e(a?null:r,a)},u=i(n);o=u.length,u.forEach(function(t){s(t.name,function(e,n){n&&(n=n.map(function(e){return{name:e,port:t.port}})),c(e,n)})})}})}function s(t,e){var n,r=[],i=function(t,i){n=n||t,i&&r.push(i),e(r.length>0?null:n,r)};c.lookup(t,i)}function a(t,e){function n(){t.removeListener("connect",n),t.removeListener("disconnect",r)}function r(){var r=e.shift();r?t.socket.connect(r.port,r.name):n()}return t.on("connect",n),t.on("disconnect",r),r()}var c=t("dns");n.connect=function(t){function e(r){var i=this;!i.socket&&t.socket?(i.socket="function"==typeof t.socket?t.socket.call(this):t.socket,t.socket=null):r||(i.socket=null);var c=n.shift();return c?o(c+"."+t.domain,function(t,n){n?a(i,n):e.call(i,"retry")}):s(t.domain,function(e,r){r&&r.length>0?(r=r.map(function(e){return{name:e,port:t.defaultPort}}),a(i,r)):i.reconnect?(n=t.services.slice(),i.socket=null):(e=e||new Error("No addresses resolved for "+t.domain),i.emit("error",e))}),i.socket}var n=t.services.slice();return e}},{dns:2}],48:[function(t,e,n){"use strict";function r(t,e){c.Element.call(this,t,e)}function i(t){r.call(this,"message",t)}function o(t){r.call(this,"presence",t)}function s(t){r.call(this,"iq",t)}var a=t("util"),c=t("ltx");

a.inherits(r,c.Element),r.prototype.clone=function(){var t=new r(this.name,{});for(var e in this.attrs)this.attrs.hasOwnProperty(e)&&(t.attrs[e]=this.attrs[e]);for(var n=0;n<this.children.length;n++){var i=this.children[n];t.cnode(i.clone?i.clone():i)}return t},Object.defineProperty(r.prototype,"from",{get:function(){return this.attrs.from},set:function(t){this.attrs.from=t}}),Object.defineProperty(r.prototype,"to",{get:function(){return this.attrs.to},set:function(t){this.attrs.to=t}}),Object.defineProperty(r.prototype,"id",{get:function(){return this.attrs.id},set:function(t){this.attrs.id=t}}),Object.defineProperty(r.prototype,"type",{get:function(){return this.attrs.type},set:function(t){this.attrs.type=t}}),a.inherits(i,r),a.inherits(o,r),a.inherits(s,r),n.Element=c.Element,n.Stanza=r,n.Message=i,n.Presence=o,n.Iq=s},{ltx:55,util:21}],49:[function(t,e,n){"use strict";function r(t){o.call(this);var e=this;this.parser=new s.bestSaxParser,this.bytesParsed=0,this.maxStanzaSize=t,this.bytesParsedOnStanzaBegin=0,this.parser.on("startElement",function(t,n){if(e.element||"stream:stream"!==t){var r;e.element?(r=new s.Element(t,n),e.element=e.element.cnode(r)):(r=new a(t,n),e.element=r,e.bytesParsedOnStanzaBegin=e.bytesParsed)}else e.emit("streamStart",n)}),this.parser.on("endElement",function(t){e.element||"stream:stream"!==t?e.element&&t===e.element.name?e.element.parent?e.element=e.element.parent:(e.emit("stanza",e.element),delete e.element,delete e.bytesParsedOnStanzaBegin):e.error("xml-not-well-formed","XML parse error"):e.end()}),this.parser.on("text",function(t){e.element&&e.element.t(t)}),this.parser.on("entityDecl",function(){e.error("xml-not-well-formed","No entity declarations allowed"),e.end()}),this.parser.on("error",this.emit.bind(this,"error"))}var i=t("util"),o=t("events").EventEmitter,s=t("ltx"),a=t("./stanza").Stanza;i.inherits(r,o),r.prototype.checkXMLHeader=function(t){var e=t.indexOf("<?xml");if(-1!==e){var n=t.indexOf("?>");if(e>=0&&n>=0&&n+2>e){var r=t.substring(e,n+2);t=t.replace(r,"")}}return t},r.prototype.write=function(t){if(this.parser){if(t=t.toString("utf8"),t=this.checkXMLHeader(t),this.bytesParsedOnStanzaBegin&&this.maxStanzaSize&&this.bytesParsed>this.bytesParsedOnStanzaBegin+this.maxStanzaSize)return void this.error("policy-violation","Maximum stanza size exceeded");this.bytesParsed+=t.length,this.parser.write(t)}},r.prototype.end=function(t){t&&this.write(t),delete this.parser,this.emit("end")},r.prototype.error=function(t,e){var n=new Error(e);n.condition=t,this.emit("error",n)},n.StreamParser=r},{"./stanza":48,events:13,ltx:55,util:21}],50:[function(t,e,n){function r(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}function i(){var t=arguments,e=this.useColors;if(t[0]=(e?"%c":"")+this.namespace+(e?" %c":" ")+t[0]+(e?"%c ":" ")+"+"+n.humanize(this.diff),!e)return t;var r="color: "+this.color;t=[t[0],r,"color: inherit"].concat(Array.prototype.slice.call(t,1));var i=0,o=0;return t[0].replace(/%[a-z%]/g,function(t){"%%"!==t&&(i++,"%c"===t&&(o=i))}),t.splice(o,0,r),t}function o(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function s(t){try{null==t?u.removeItem("debug"):u.debug=t}catch(e){}}function a(){var t;try{t=u.debug}catch(e){}return t}function c(){try{return window.localStorage}catch(t){}}n=e.exports=t("./debug"),n.log=o,n.formatArgs=i,n.save=s,n.load=a,n.useColors=r;var u;u="undefined"!=typeof chrome&&"undefined"!=typeof chrome.storage?chrome.storage.local:c(),n.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],n.formatters.j=function(t){return JSON.stringify(t)},n.enable(a())},{"./debug":51}],51:[function(t,e,n){arguments[4][42][0].apply(n,arguments)},{ms:52}],52:[function(t,e,n){function r(t){var e=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(t);if(e){var n=parseFloat(e[1]),r=(e[2]||"ms").toLowerCase();switch(r){case"years":case"year":case"yrs":case"yr":case"y":return n*h;case"days":case"day":case"d":return n*l;case"hours":case"hour":case"hrs":case"hr":case"h":return n*u;case"minutes":case"minute":case"mins":case"min":case"m":return n*c;case"seconds":case"second":case"secs":case"sec":case"s":return n*a;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n}}}function i(t){return t>=l?Math.round(t/l)+"d":t>=u?Math.round(t/u)+"h":t>=c?Math.round(t/c)+"m":t>=a?Math.round(t/a)+"s":t+"ms"}function o(t){return s(t,l,"day")||s(t,u,"hour")||s(t,c,"minute")||s(t,a,"second")||t+" ms"}function s(t,e,n){return e>t?void 0:1.5*e>t?Math.floor(t/e)+" "+n:Math.ceil(t/e)+" "+n+"s"}var a=1e3,c=60*a,u=60*c,l=24*u,h=365.25*l;e.exports=function(t,e){return e=e||{},"string"==typeof t?r(t):e["long"]?o(t):i(t)}},{}],53:[function(t,e,n){arguments[4][22][0].apply(n,arguments)},{"./element":54,util:21}],54:[function(t,e,n){"use strict";function r(t,e){this.name=t,this.parent=null,this.children=[],this.setAttrs(e)}function i(t){return t.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/"/g,"&apos;")}function o(t){return t.replace(/\&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}r.prototype.is=function(t,e){return this.getName()===t&&(!e||this.getNS()===e)},r.prototype.getName=function(){return this.name.indexOf(":")>=0?this.name.substr(this.name.indexOf(":")+1):this.name},r.prototype.getNS=function(){if(this.name.indexOf(":")>=0){var t=this.name.substr(0,this.name.indexOf(":"));return this.findNS(t)}return this.findNS()},r.prototype.findNS=function(t){if(t){var e="xmlns:"+t;if(this.attrs[e])return this.attrs[e];if(this.parent)return this.parent.findNS(t)}else{if(this.attrs.xmlns)return this.attrs.xmlns;if(this.parent)return this.parent.findNS()}},r.prototype.getXmlns=function(){var t={};this.parent&&(t=this.parent.getXmlns());for(var e in this.attrs){var n=e.match("xmlns:?(.*)");this.attrs.hasOwnProperty(e)&&n&&(t[this.attrs[e]]=n[1])}return t},r.prototype.setAttrs=function(t){this.attrs={},"string"==typeof t?this.attrs.xmlns=t:t&&Object.keys(t).forEach(function(e){this.attrs[e]=t[e]},this)},r.prototype.getAttr=function(t,e){if(!e)return this.attrs[t];var n=this.getXmlns();return n[e]?this.attrs[[n[e],t].join(":")]:null},r.prototype.getChild=function(t,e){return this.getChildren(t,e)[0]},r.prototype.getChildren=function(t,e){for(var n=[],r=0;r<this.children.length;r++){var i=this.children[r];!i.getName||i.getName()!==t||e&&i.getNS()!==e||n.push(i)}return n},r.prototype.getChildByAttr=function(t,e,n,r){return this.getChildrenByAttr(t,e,n,r)[0]},r.prototype.getChildrenByAttr=function(t,e,n,r){for(var i=[],o=0;o<this.children.length;o++){var s=this.children[o];!s.attrs||s.attrs[t]!==e||n&&s.getNS()!==n||i.push(s),r&&s.getChildrenByAttr&&i.push(s.getChildrenByAttr(t,e,n,!0))}return r&&(i=[].concat.apply([],i)),i},r.prototype.getChildrenByFilter=function(t,e){for(var n=[],r=0;r<this.children.length;r++){var i=this.children[r];t(i)&&n.push(i),e&&i.getChildrenByFilter&&n.push(i.getChildrenByFilter(t,!0))}return e&&(n=[].concat.apply([],n)),n},r.prototype.getText=function(){for(var t="",e=0;e<this.children.length;e++){var n=this.children[e];("string"==typeof n||"number"==typeof n)&&(t+=n)}return t},r.prototype.getChildText=function(t,e){var n=this.getChild(t,e);return n?n.getText():null},r.prototype.getChildElements=function(){return this.getChildrenByFilter(function(t){return t instanceof r})},r.prototype.root=function(){return this.parent?this.parent.root():this},r.prototype.tree=r.prototype.root,r.prototype.up=function(){return this.parent?this.parent:this},r.prototype._getElement=function(t,e){var n=new r(t,e);return n},r.prototype.c=function(t,e){return this.cnode(this._getElement(t,e))},r.prototype.cnode=function(t){return this.children.push(t),"object"==typeof t&&(t.parent=this),t},r.prototype.t=function(t){return this.children.push(t),this},r.prototype.remove=function(t,e){var n;return n="string"==typeof t?function(n){return!(n.is&&n.is(t,e))}:function(e){return e!==t},this.children=this.children.filter(n),this},r.prototype.clone=function(){for(var t=this._getElement(this.name,this.attrs),e=0;e<this.children.length;e++){var n=this.children[e];t.cnode(n.clone?n.clone():n)}return t},r.prototype.text=function(t){return t&&1===this.children.length?(this.children[0]=t,this):this.getText()},r.prototype.attr=function(t,e){return"undefined"!=typeof e||null===e?(this.attrs||(this.attrs={}),this.attrs[t]=e,this):this.attrs[t]},r.prototype.toString=function(){var t="";return this.write(function(e){t+=e}),t},r.prototype.toJSON=function(){return{name:this.name,attrs:this.attrs,children:this.children.map(function(t){return t&&t.toJSON?t.toJSON():t})}},r.prototype._addChildren=function(t){t(">");for(var e=0;e<this.children.length;e++){var n=this.children[e];(n||0===n)&&(n.write?n.write(t):"string"==typeof n?t(o(n)):n.toString&&t(o(n.toString(10))))}t("</"),t(this.name),t(">")},r.prototype.write=function(t){t("<"),t(this.name);for(var e in this.attrs){var n=this.attrs[e];(n||""===n||0===n)&&(t(" "),t(e),t('="'),"string"!=typeof n&&(n=n.toString(10)),t(i(n)),t('"'))}0===this.children.length?t("/>"):this._addChildren(t)},n.Element=r,n.escapeXml=i},{}],55:[function(t,e,n){arguments[4][24][0].apply(n,arguments)},{"./index":56,"./parse":57,"./sax/sax_ltx":58}],56:[function(t,e,n){arguments[4][25][0].apply(n,arguments)},{"./dom-element":53,"./element":54,"./parse":57}],57:[function(t,e,n){arguments[4][26][0].apply(n,arguments)},{"./dom-element":53,events:13,util:21}],58:[function(t,e,n){e.exports=t(27)},{events:13,util:21}],59:[function(t,e,n){(function(n){"use strict";var r=t("debug")("node-stringprep"),i=1,o=2;try{var s=t("bindings")("node_stringprep.node")}catch(a){"browser"!==n.title&&(console.log("Cannot load StringPrep-"+t("./package.json").version+" bindings (using fallback). You may need to `npm install node-stringprep`"),r(a))}var c=function(t,e){e=e||{};try{return s.toUnicode(t,0|(e.allowUnassigned&&i))}catch(n){return t}},u=function(t,e){e=e||{};try{return s.toASCII(t,(e.allowUnassigned&&i)|(e.useSTD3Rules&&o))}catch(n){if(e.throwIfError)throw n;return t}},l=function(t){this.operation=t;try{this.stringPrep=new s.StringPrep(this.operation)}catch(e){this.stringPrep=null,r("Operation does not exist",t,e)}};l.prototype.UNKNOWN_PROFILE_TYPE="Unknown profile type",l.prototype.UNHANDLED_FALLBACK="Unhandled JS fallback",l.prototype.LIBICU_NOT_AVAILABLE="libicu unavailable",l.prototype.useJsFallbacks=!0,l.prototype.prepare=function(t){this.value=t;try{if(this.stringPrep)return this.stringPrep.prepare(this.value)}catch(e){}if(!1===this.useJsFallbacks)throw new Error(this.LIBICU_NOT_AVAILABLE);return this.jsFallback()},l.prototype.isNative=function(){return null!==this.stringPrep},l.prototype.jsFallback=function(){switch(this.operation){case"nameprep":case"nodeprep":return this.value.toLowerCase();case"resourceprep":return this.value;case"nfs4_cs_prep":case"nfs4_cis_prep":case"nfs4_mixed_prep prefix":case"nfs4_mixed_prep suffix":case"iscsi":case"mib":case"saslprep":case"trace":case"ldap":case"ldapci":throw new Error(this.UNHANDLED_FALLBACK);default:throw new Error(this.UNKNOWN_PROFILE_TYPE)}},l.prototype.disableJsFallbacks=function(){this.useJsFallbacks=!1},l.prototype.enableJsFallbacks=function(){this.useJsFallbacks=!0},e.exports={toUnicode:c,toASCII:u,StringPrep:l}}).call(this,t("1YiZ5S"))},{"./package.json":64,"1YiZ5S":16,bindings:60,debug:61}],60:[function(t,e,n){(function(r,i){function o(e){"string"==typeof e?e={bindings:e}:e||(e={}),e.__proto__=h,e.module_root||(e.module_root=n.getRoot(n.getFileName())),".node"!=a.extname(e.bindings)&&(e.bindings+=".node");for(var r,i,o,s=[],u=0,l=e["try"].length;l>u;u++){r=c.apply(null,e["try"][u].map(function(t){return e[t]||t})),s.push(r);try{return i=e.path?t.resolve(r):t(r),e.path||(i.path=r),i}catch(p){if(!/not find/i.test(p.message))throw p}}throw o=new Error("Could not locate the bindings file. Tried:\n"+s.map(function(t){return e.arrow+t}).join("\n")),o.tries=s,o}var s=t("fs"),a=t("path"),c=a.join,u=a.dirname,l=s.existsSync||a.existsSync,h={arrow:r.env.NODE_BINDINGS_ARROW||" → ",compiled:r.env.NODE_BINDINGS_COMPILED_DIR||"compiled",platform:r.platform,arch:r.arch,version:r.versions.node,bindings:"bindings.node","try":[["module_root","build","bindings"],["module_root","build","Debug","bindings"],["module_root","build","Release","bindings"],["module_root","out","Debug","bindings"],["module_root","Debug","bindings"],["module_root","out","Release","bindings"],["module_root","Release","bindings"],["module_root","build","default","bindings"],["module_root","compiled","version","platform","arch","bindings"]]};e.exports=n=o,n.getFileName=function(t){var e,n=Error.prepareStackTrace,r=Error.stackTraceLimit,o={};return Error.stackTraceLimit=10,Error.prepareStackTrace=function(n,r){for(var o=0,s=r.length;s>o;o++)if(e=r[o].getFileName(),e!==i){if(!t)return;if(e!==t)return}},Error.captureStackTrace(o),o.stack,Error.prepareStackTrace=n,Error.stackTraceLimit=r,e},n.getRoot=function(t){for(var e,n=u(t);;){if("."===n&&(n=r.cwd()),l(c(n,"package.json"))||l(c(n,"node_modules")))return n;if(e===n)throw new Error('Could not find module root given file: "'+t+'". Do you have a `package.json` file? ');e=n,n=c(n,"..")}}}).call(this,t("1YiZ5S"),"/../node_modules/node-xmpp-client/node_modules/node-xmpp-core/node_modules/node-stringprep/node_modules/bindings/bindings.js")},{"1YiZ5S":16,fs:2,path:15}],61:[function(t,e,n){e.exports=t(41)},{"./debug":62}],62:[function(t,e,n){e.exports=t(42)},{ms:63}],63:[function(t,e,n){e.exports=t(43)},{}],64:[function(t,e,n){e.exports={name:"node-stringprep",version:"0.7.0",main:"index.js",description:"ICU StringPrep profiles",keywords:["unicode","stringprep","icu"],scripts:{test:"grunt test",install:"node-gyp rebuild"},dependencies:{bindings:"^1.2.1",debug:"~2.0.0",nan:"^1.5.1"},devDependencies:{grunt:"~0.4.2","grunt-cli":"^0.1.13","grunt-contrib-jshint":"~0.7.2","grunt-mocha-cli":"~1.3.0",proxyquire:"~0.5.2",should:"~2.1.1"},repository:{type:"git",path:"git://github.com/node-xmpp/node-stringprep.git"},homepage:"http://github.com/node-xmpp/node-stringprep",bugs:{url:"http://github.com/node-xmpp/node-stringprep/issues"},author:{name:"Lloyd Watkin",email:"lloyd@evilprofessor.co.uk",url:"http://evilprofessor.co.uk"},licenses:[{type:"MIT"}],engines:{node:">=0.8"},gypfile:!0,gitHead:"de3b45ec215e592331b9b80c053b3322656907a4",_id:"node-stringprep@0.7.0",_shasum:"c8a8deac9217db97ef3eb20dfa817d7e716f56b5",_from:"node-stringprep@^0.7.0",_npmVersion:"2.2.0",_nodeVersion:"1.0.3",_npmUser:{name:"lloydwatkin",email:"lloyd@evilprofessor.co.uk"},maintainers:[{name:"astro",email:"astro@spaceboyz.net"},{name:"lloydwatkin",email:"lloyd@evilprofessor.co.uk"}],dist:{shasum:"c8a8deac9217db97ef3eb20dfa817d7e716f56b5",tarball:"http://registry.npmjs.org/node-stringprep/-/node-stringprep-0.7.0.tgz"},directories:{},_resolved:"https://registry.npmjs.org/node-stringprep/-/node-stringprep-0.7.0.tgz"}},{}],65:[function(t,e,n){var r=t("events").EventEmitter,i=t("backoff"),o=function(){};e.exports=function(t){return function(e,n){function s(r,i){function s(t){l=o,f.removeListener("connect",p),f.removeListener("error",h),f.removeListener("close",h),f.removeListener("end",h),"Request"==f.constructor.name&&f.on("error",o)}function h(t){if(a.connected=!1,s(t),a.emit("disconnect",t),a.reconnect)try{c.backoff()}catch(e){}}function p(){c.reset(),a.connected=!0,n&&f.removeListener("connect",n),a.emit("connect",f)}if(a.reconnect){l(),a.emit("reconnect",r,i);var f=t.apply(null,u);f!==a._connection&&a.emit("connection",f),a._connection=f,l=s,f.on("error",h).on("close",h).on("end",h),e.immediate||"Request"==f.constructor.name?(a.connected=!0,a.emit("connect",f),f.once("data",function(){c.reset()})):f.on("connect",p)}}n="function"==typeof e?e:n,e="object"==typeof e?e:{initialDelay:1e3,maxDelay:3e4},n||(n=e.onConnect);var a=e.emitter||new r;a.connected=!1,a.reconnect=!0,n&&a.on("connect",n);var c=(i[e.type]||i.fibonacci)(e);c.on("backoff",function(t,e){a.emit("backoff",t,e)});var u,l=o;return c.on("ready",s),a.connect=a.listen=function(){return this.reconnect=!0,c.reset(),u=[].slice.call(arguments),s(0,0),a},a.end=a.disconnect=function(){return a.reconnect=!1,a._connection&&a._connection.end(),a.emit("disconnect"),a},a}}},{backoff:66,events:13}],66:[function(t,e,n){var r=t("./lib/backoff"),i=t("./lib/strategy/exponential"),o=t("./lib/strategy/fibonacci"),s=t("./lib/function_call.js");e.exports.Backoff=r,e.exports.FunctionCall=s,e.exports.FibonacciStrategy=o,e.exports.ExponentialStrategy=i,e.exports.fibonacci=function(t){return new r(new o(t))},e.exports.exponential=function(t){return new r(new i(t))},e.exports.call=function(t,e,n){var r=Array.prototype.slice.call(arguments);return t=r[0],e=r.slice(1,r.length-1),n=r[r.length-1],new s(t,e,n)}},{"./lib/backoff":67,"./lib/function_call.js":68,"./lib/strategy/exponential":69,"./lib/strategy/fibonacci":70}],67:[function(t,e,n){function r(t){i.EventEmitter.call(this),this.backoffStrategy_=t,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}var i=t("events"),o=t("util");o.inherits(r,i.EventEmitter),r.prototype.failAfter=function(t){if(1>t)throw new Error("Maximum number of retry must be greater than 0. Actual: "+t);this.maxNumberOfRetry_=t},r.prototype.backoff=function(t){if(-1!==this.timeoutID_)throw new Error("Backoff in progress.");this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",t),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,t))},r.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},r.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1},e.exports=r},{events:13,util:21}],68:[function(t,e,n){function r(t){return"function"==typeof t}function i(t,e,n){if(o.EventEmitter.call(this),!r(t))throw new Error("fn should be a function.Actual: "+typeof t);if(!r(n))throw new Error("callback should be a function.Actual: "+typeof t);this.function_=t,this.arguments_=e,this.callback_=n,this.results_=[],this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.state_=i.State_.PENDING}var o=t("events"),s=t("util"),a=t("./backoff"),c=t("./strategy/fibonacci");s.inherits(i,o.EventEmitter),i.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},i.prototype.isPending=function(){return this.state_==i.State_.PENDING},i.prototype.isRunning=function(){return this.state_==i.State_.RUNNING},i.prototype.isCompleted=function(){return this.state_==i.State_.COMPLETED},i.prototype.isAborted=function(){return this.state_==i.State_.ABORTED},i.prototype.setStrategy=function(t){if(!this.isPending())throw new Error("FunctionCall in progress.");return this.strategy_=t,this},i.prototype.getResults=function(){return this.results_.concat()},i.prototype.failAfter=function(t){if(!this.isPending())throw new Error("FunctionCall in progress.");return this.failAfter_=t,this},i.prototype.abort=function(){if(this.isCompleted())throw new Error("FunctionCall already completed.");this.isRunning()&&this.backoff_.reset(),this.state_=i.State_.ABORTED},i.prototype.start=function(t){if(this.isAborted())throw new Error("FunctionCall aborted.");if(!this.isPending())throw new Error("FunctionCall already started.");var e=this.strategy_||new c;this.backoff_=t?t(e):new a(e),this.backoff_.on("ready",this.doCall_.bind(this)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=i.State_.RUNNING,this.doCall_()},i.prototype.doCall_=function(){var t=["call"].concat(this.arguments_);o.EventEmitter.prototype.emit.apply(this,t);var e=this.handleFunctionCallback_.bind(this);this.function_.apply(null,this.arguments_.concat(e))},i.prototype.doCallback_=function(){var t=this.results_[this.results_.length-1];this.callback_.apply(null,t)},i.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var t=Array.prototype.slice.call(arguments);this.results_.push(t),o.EventEmitter.prototype.emit.apply(this,["callback"].concat(t)),t[0]?this.backoff_.backoff(t[0]):(this.state_=i.State_.COMPLETED,this.doCallback_())}},i.prototype.handleBackoff_=function(t,e,n){this.emit("backoff",t,e,n)},e.exports=i},{"./backoff":67,"./strategy/fibonacci":70,events:13,util:21}],69:[function(t,e,n){function r(t){o.call(this,t),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}var i=t("util"),o=t("./strategy");i.inherits(r,o),r.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=2*this.backoffDelay_,this.backoffDelay_},r.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()},e.exports=r},{"./strategy":71,util:21}],70:[function(t,e,n){function r(t){o.call(this,t),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}var i=t("util"),o=t("./strategy");i.inherits(r,o),r.prototype.next_=function(){var t=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=t,t},r.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0},e.exports=r},{"./strategy":71,util:21}],71:[function(t,e,n){function r(t){return void 0!==t&&null!==t}function i(t){if(t=t||{},r(t.initialDelay)&&t.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(r(t.maxDelay)&&t.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=t.initialDelay||100,this.maxDelay_=t.maxDelay||1e4,this.maxDelay_<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(r(t.randomisationFactor)&&(t.randomisationFactor<0||t.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=t.randomisationFactor||0}t("events"),t("util");i.prototype.getMaxDelay=function(){return this.maxDelay_},i.prototype.getInitialDelay=function(){return this.initialDelay_},i.prototype.next=function(){var t=this.next_(),e=1+Math.random()*this.randomisationFactor_,n=Math.round(t*e);return n},i.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},i.prototype.reset=function(){this.reset_()},i.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")},e.exports=i},{events:13,util:21}],72:[function(t,e,n){(function(n){"use strict";function r(t){var e={};"object"==typeof t[0]?e=t[0]:isPipeName(t[0])?e.path=t[0]:(e.port=t[0],"string"==typeof t[1]&&(e.host=t[1]));var n=t[t.length-1];return"function"==typeof n?[e,n]:[e]}function i(t,e){function n(t,e){if(/\.$/.test(t)||(t+="."),!e&&/\*/.test(t)||/[\.\*].*\*/.test(t)||/\*/.test(t)&&!/\*.*\..+\..+/.test(t))return/$./;var n=t.replace(/\*([a-z0-9\\-_\.])|[\.,\-\\\^\$+?*\[\]\(\):!\|{}]/g,function(t,e){return e?"[a-z0-9\\-_]*"+("-"===e?"\\-":e):"\\"+t});return new RegExp("^"+n+"$","i")}var r=[],i=[],o=[],s=!0,a=!1;if(e.subjectaltname&&e.subjectaltname.split(/, /g).forEach(function(t){if(/^DNS:/.test(t))r.push(t.slice(4));else if(/^IP Address:/.test(t))o.push(t.slice(11));else if(/^URI:/.test(t)){var e=url.parse(t.slice(4));e&&i.push(e.hostname)}}),u.isIP(t))a=o.some(function(e){return e===t});else{if(/\.$/.test(t)||(t+="."),r=r.map(function(t){return n(t,!0)}),i=i.map(function(t){return n(t,!1)}),r=r.concat(i),r.length>0&&(s=!1),s){var c=e.subject.CN;if(h.isArray(c))for(var l=0,p=c.length;p>l;++l)r.push(n(c[l],!0));else r.push(n(c,!0))}a=r.some(function(e){return e.test(t)})}return a}function o(t){var e=r(t),n=e[0],i=e[1];return"object"==typeof t[1]?n=h._extend(n,t[1]):"object"==typeof t[2]&&(n=h._extend(n,t[2])),i?[n,i]:[n]}function s(t,e,n,r){p(e.socket);var i=l.createSecurePair(r,!!e.isServer,!!e.requestCert,!!e.rejectUnauthorized,{NPNProtocols:n.NPNProtocols,servername:t});return c(i,e.socket),i.cleartext._controlReleased=!0,i.on("error",function(t){i.cleartext.emit("error",t)}),i}function a(){function t(){function t(){if(!g._hadError){g._hadError=!0;var t=new Error("socket hang up");t.code="ECONNRESET",g.destroy(),g.emit("error",t)}}y||g._releaseControl(),r.session&&g.setSession(r.session),y||(r.servername&&g.setServername(r.servername),r.isServer||g._start()),g.on("secure",function(){var e=g._ssl||g.ssl,n=e.verifyError();if(!n){var o=v.getPeerCertificate(),s=i(u,o);s||(n=new Error("Hostname/IP doesn't match certificate's altnames"))}if(n){if(v.authorized=!1,v.authorizationError=n.message,r.rejectUnauthorized)return v.emit("error",n),void v.destroy();v.emit("secureConnect")}else v.authorized=!0,v.emit("secureConnect");v.removeListener("end",t)}),v.once("end",t)}var e=o(arguments),r=e[0],a=e[1],c={rejectUnauthorized:"0"!==n.env.NODE_TLS_REJECT_UNAUTHORIZED,requestCert:!0,isServer:!1};r=h._extend(c,r||{});var u=r.servername||r.host||r.socket&&r.socket._host||"127.0.0.1",d={},m=r.credentials||f.createCredentials(r);l.convertNPNProtocols&&l.convertNPNProtocols(r.NPNProtocols,d);var g,y,v;if("undefined"==typeof l.TLSSocket?(y=!0,g=s(u,r,d,m),v=g.cleartext):(y=!1,g=new l.TLSSocket(r.socket,{credentials:m,isServer:!!r.isServer,requestCert:!!r.requestCert,rejectUnauthorized:!!r.rejectUnauthorized,NPNProtocols:d.NPNProtocols}),v=g),g._handle&&!g._connecting?t():(!y&&r.socket&&r.socket.once("connect",function(){p(r.socket._handle),g._handle=r.socket._handle,g._handle.owner=g,g.emit("connect")}),g.once("connect",t)),a&&v.once("secureConnect",a),!r.socket){p(!y);var b;b=r.path&&!r.port?{path:r.path}:{port:r.port,host:r.host,localAddress:r.localAddress},g.connect(b)}return v}function c(t,e){function r(t){s._controlReleased&&s.emit("error",t)}function i(){e.removeListener("error",r),e.removeListener("timeout",o)}function o(){s.emit("timeout")}t.encrypted.pipe(e),e.pipe(t.encrypted),t.encrypted.on("close",function(){n.nextTick(function(){t.encrypted.unpipe&&t.encrypted.unpipe(e),e.destroySoon()})}),t.fd=e.fd,t._handle=e._handle;var s=t.cleartext;return s.socket=e,s.encrypted=t.encrypted,s.authorized=!1,e.on("drain",function(){t.encrypted._pending&&t.encrypted._writePending&&t.encrypted._writePending(),t.cleartext._pending&&t.cleartext._writePending&&t.cleartext._writePending(),t.encrypted.read&&t.encrypted.read(0),t.cleartext.read&&t.cleartext.read(0)}),e.on("error",r),e.on("close",i),e.on("timeout",o),s}e.exports=a,a.connect=a;var u=t("net"),l=t("tls"),h=t("util"),p=t("assert"),f=t("crypto")}).call(this,t("1YiZ5S"))},{"1YiZ5S":16,assert:3,crypto:8,net:2,tls:2,util:21}]},{},[1]);